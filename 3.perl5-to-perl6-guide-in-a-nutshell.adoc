== Perl 5 åˆ° Perl 6 çš„æŒ‡å— - ç®€è€Œè¨€ä¹‹

è¿™ä¸ªé¡µé¢è¯•å›¾æä¾›ä» Perl 5 åˆ° Perl 6 çš„è¯­æ³•å’Œè¯­ä¹‰å˜åŒ–çš„å¿«é€Ÿè·¯å¾„ã€‚æ— è®ºåœ¨ Perl 5 ä¸­æœ‰ä»€ä¹ˆç”¨ï¼Œå¿…é¡»åœ¨ Perl 6 ä¸­ä»¥ä¸åŒçš„æ–¹å¼ç¼–å†™ï¼Œè¿™é‡Œåº”è¯¥åˆ—å‡ºï¼ˆè€Œè®¸å¤šæ–°çš„ Perl 6 ç‰¹æ€§å’Œæƒ¯ç”¨æ³•ï¼‰ä¸éœ€è¦ï¼‰ã€‚

å› æ­¤ï¼Œè¿™ä¸åº”è¯¥è¢«è¯¯è®¤ä¸ºåˆå­¦è€…æ•™ç¨‹æˆ– Perl 6 çš„å®£ä¼ æ¦‚è¿°;å®ƒæ—¨åœ¨ä½œä¸º Perl 6 å­¦ä¹ è€…çš„æŠ€æœ¯å‚è€ƒï¼Œå…·æœ‰å¼ºå¤§çš„ Perl 5 èƒŒæ™¯ï¼Œä»¥åŠä»»ä½•å°† Perl 5 ä»£ç ç§»æ¤åˆ° Perl 6 çš„äººï¼ˆå°½ç®¡æ³¨æ„åˆ°è‡ªåŠ¨ç¿»è¯‘å¯èƒ½æ›´æ–¹ä¾¿ï¼‰ã€‚

å…³äºè¯­ä¹‰çš„æ³¨é‡Š;å½“æˆ‘ä»¬åœ¨æœ¬æ–‡æ¡£ä¸­è¯´â€œç°åœ¨â€æ—¶ï¼Œæˆ‘ä»¬å¤§å¤šåªæ˜¯è¯´â€œç°åœ¨ä½ æ­£åœ¨è¯•ç”¨ Perl 6â€ã€‚æˆ‘ä»¬å¹¶ä¸æ˜¯è¦æš—ç¤º Perl 5 ç°åœ¨çªç„¶è¿‡æ—¶äº†ã€‚æ°æ°ç›¸åï¼Œæˆ‘ä»¬å¤§å¤šæ•°äººéƒ½å–œæ¬¢ Perl 5ï¼Œæˆ‘ä»¬æœŸæœ› Perl 5 èƒ½å¤Ÿç»§ç»­ä½¿ç”¨å¤šå¹´ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬æ›´é‡è¦çš„ç›®æ ‡ä¹‹ä¸€æ˜¯ä½¿ Perl 5 å’Œ Perl 6 ä¹‹é—´çš„äº¤äº’é¡ºåˆ©è¿›è¡Œã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä¹Ÿå–œæ¬¢ Perl 6 ä¸­çš„è®¾è®¡å†³ç­–ï¼Œå®ƒä»¬æ¯” Perl 5 ä¸­çš„è®¸å¤šå†å²è®¾è®¡å†³ç­–æ›´æ–°ï¼Œå¯ä»¥è¯´æ˜¯æ›´å¥½çš„é›†æˆã€‚æˆ‘ä»¬å¾ˆå¤šäººéƒ½å¸Œæœ›åœ¨æ¥ä¸‹æ¥çš„åå¹´æˆ–ä¸¤å¹´å†…ï¼ŒPerl 6 å°†æˆä¸ºæ›´ä¸»è¦çš„è¯­è¨€ã€‚å¦‚æœä½ æƒ³åœ¨æœªæ¥çš„æ„ä¹‰ä¸Šé‡‡å–â€œç°åœ¨â€ï¼Œé‚£ä¹Ÿæ²¡å…³ç³»ã€‚ä½†æ˜¯æˆ‘ä»¬æ ¹æœ¬ä¸ä¼šå¯¹å¯¼è‡´æˆ˜æ–—çš„ä»»ä½•/æˆ–è€…æ€è€ƒæ„Ÿå…´è¶£ã€‚

=== CPAN

å‚è€ƒ link:https://modules.perl6.org/[https://modules.perl6.org/]

å¦‚æœæ‚¨ä½¿ç”¨çš„æ¨¡å—å°šæœªè½¬æ¢ä¸º Perl 6ï¼Œå¹¶ä¸”æœ¬æ–‡æ¡£ä¸­æœªåˆ—å‡ºä»»ä½•æ›¿ä»£æ–¹æ¡ˆï¼Œåˆ™å¯èƒ½å°šæœªè§£å†³å…¶åœ¨ Perl 6 ä¸‹çš„ä½¿ç”¨é—®é¢˜ã€‚

link:https://github.com/niner/Inline-Perl5/[Inline::Perl5] é¡¹ç›®é€šè¿‡ä½¿ç”¨ Perl è§£é‡Šå™¨çš„åµŒå…¥å¼å®ä¾‹æ¥è¿è¡Œ Perl 5 ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» Perl 6 ä»£ç ä¸­ä½¿ç”¨ Perl 5 æ¨¡å—ã€‚

è¿™å¾ˆç®€å•ï¼š

```perl
# the :from<Perl5> makes Perl 6 load Inline::Perl5 first (if installed) 
# and then load the Scalar::Util module from Perl 5 
use Scalar::Util:from<Perl5> <looks_like_number>;
say looks_like_number "foo";   # 0 
say looks_like_number "42";    # 1 
```

è®¸å¤š Perl 5 æ¨¡å—å·²ç»ç§»æ¤åˆ° Perl 6ï¼Œè¯•å›¾å°½å¯èƒ½å¤šåœ°ç»´æŠ¤è¿™äº›æ¨¡å—çš„ APIï¼Œä½œä¸º CPAN Butterfly Plan çš„ä¸€éƒ¨åˆ†ã€‚ è¿™äº›å¯ä»¥åœ¨ link:https://modules.perl6.org/t/CPAN5[https://modules.perl6.org/t/CPAN5] æ‰¾åˆ°ã€‚

è®¸å¤š Perl 5 å†…ç½®å‡½æ•°ï¼ˆç›®å‰å¤§çº¦ 100ä¸ªï¼‰å·²ç»ä»¥ç›¸åŒçš„è¯­ä¹‰ç§»æ¤åˆ° Perl 6ã€‚ è€ƒè™‘ä¸€ä¸‹ Perl 5 ä¸­çš„ shift å‡½æ•°é»˜è®¤æƒ…å†µä¸‹ä» `@_` æˆ– `@ARGV` è½¬ç§»ï¼Œå…·ä½“å–å†³äºä¸Šä¸‹æ–‡ã€‚ è¿™äº›å¯ä»¥åœ¨ link:https://modules.perl6.org/t/Perl5[https://modules.perl6.org/t/Perl5] æ‰¾åˆ°ï¼Œä½œä¸ºå¯å•ç‹¬åŠ è½½çš„æ¨¡å—ï¼Œåœ¨ link:https://modules.perl6.org/dist/P5built-ins[P5built-ins] åŒ…ä¸­å¯ä»¥ä¸€æ¬¡æ€§è·å–æ‰€æœ‰è¿™äº›æ¨¡å—ã€‚

=== è¯­æ³•

ä¸¤ç§è¯­è¨€ä¹‹é—´çš„è¯­æ³•æœ‰ä¸€äº›å·®å¼‚ï¼Œä»å¦‚ä½•å®šä¹‰æ ‡è¯†ç¬¦å¼€å§‹ã€‚

==== æ ‡è¯†ç¬¦

Perl 6 å…è®¸åœ¨æ ‡è¯†ç¬¦ä¸­ä½¿ç”¨ç ´æŠ˜å·ï¼ˆ `-` ï¼‰ï¼Œä¸‹åˆ’çº¿ï¼ˆ`_`ï¼‰ï¼Œæ’‡å·ï¼ˆ`'`ï¼‰å’Œå­—æ¯æ•°å­—ï¼š

```perl6
sub test-doesn't-hang { ... }
my $à¸„à¸§à¸²à¸¡à¸ªà¸‡à¸š = 42;
my \Î” = 72; say 72 - Î”;
```

==== link:https://docs.perl6.org/language/5to6-nutshell#___top[->] æ–¹æ³•è°ƒç”¨

å¦‚æœæ‚¨å·²ç»é˜…è¯»è¿‡ä»»ä½• Perl 6 ä»£ç ï¼Œé‚£ä¹ˆå¾ˆæ˜æ˜¾ï¼Œæ–¹æ³•è°ƒç”¨è¯­æ³•ç°åœ¨ä½¿ç”¨çš„æ˜¯ç‚¹è€Œä¸æ˜¯ç®­å¤´ï¼š

```perl
$person->name  # Perl 5 
```

```perl6
$person.name   # Perl 6 
```

ç‚¹ç¬¦å·æ›´å®¹æ˜“é”®å…¥ï¼Œæ›´ç¬¦åˆè¡Œä¸šæ ‡å‡†ã€‚ ä½†æˆ‘ä»¬ä¹Ÿæƒ³å·å–å…¶ä»–ä¸œè¥¿çš„ç®­å¤´ã€‚ ï¼ˆå¦‚æœä½ æƒ³çŸ¥é“çš„è¯ï¼Œç°åœ¨ç”¨ `~` è¿ç®—ç¬¦å®Œæˆè¿æ¥ã€‚ï¼‰

è¦è°ƒç”¨åœ¨è¿è¡Œæ—¶ä¹‹å‰åç§°æœªçŸ¥çš„æ–¹æ³•ï¼š

```perl
$object->$methodname(@args);  # Perl 5 
```

```perl6
$object."$methodname"(@args); # Perl 6
```

å¦‚æœçœç•¥å¼•å·ï¼Œé‚£ä¹ˆ Perl 6 è¦æ±‚ `$methodname` åŒ…å«ä¸€ä¸ª `Method` å¯¹è±¡ï¼Œè€Œä¸æ˜¯è¯¥æ–¹æ³•çš„ç®€å•å­—ç¬¦ä¸²åç§°ã€‚ æ˜¯çš„ï¼ŒPerl 6 ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚

=== ç©ºç™½

å³ä½¿å¯ç”¨äº†ä¸¥æ ¼çš„æ¨¡å¼å’Œè­¦å‘Šï¼ŒPerl 5ä¹Ÿå…è®¸åœ¨ä½¿ç”¨ç©ºæ ¼æ—¶å…·æœ‰æƒŠäººçš„çµæ´»æ€§ï¼š

```perl
# unidiomatic but valid Perl 5 
say"Hello ".ucfirst  ($people
    [$ i]
    ->
    name)."!"if$greeted[$i]<1;
```

Perl 6 è¿˜æ”¯æŒç¨‹åºå‘˜çš„è‡ªç”±å’Œåˆ›é€ åŠ›ï¼Œä½†å¹³è¡¡è¯­æ³•çµæ´»æ€§ä¸å…¶è®¾è®¡ç›®æ ‡ä¸€è‡´ï¼Œå³å…·æœ‰æ”¯æŒå•éè§£æå’Œæœ‰ç”¨é”™è¯¯æ¶ˆæ¯çš„ä¸€è‡´ï¼Œç¡®å®šæ€§ï¼Œå¯æ‰©å±•è¯­æ³•ï¼Œå¹²å‡€åœ°é›†æˆè‡ªå®šä¹‰è¿ç®—ç¬¦ç­‰åŠŸèƒ½ï¼Œå¹¶ä¸”ä¸ä¼šå¼•å¯¼ç¨‹åºå‘˜ æ„å¤–åœ°é”™è¯¯è¡¨è¾¾ä»–ä»¬çš„æ„å›¾ã€‚ æ­¤å¤–ï¼Œâ€œä»£ç é«˜å°”å¤«â€çš„å®è·µç•¥å¾®ä¸å†å¼ºè°ƒ; Perl 6 çš„è®¾è®¡ç†å¿µæ¯”æŒ‰é”®æ›´ç®€æ´ã€‚

å› æ­¤ï¼Œè¯­æ³•ä¸­æœ‰è®¸å¤šåœ°æ–¹ï¼Œå…¶ä¸­ç©ºæ ¼åœ¨ Perl 5 ä¸­æ˜¯å¯é€‰çš„ï¼Œä½†åœ¨ Perl 6 ä¸­æ˜¯å¼ºåˆ¶çš„æˆ–ç¦æ­¢çš„ã€‚è®¸å¤šè¿™äº›é™åˆ¶ä¸å¤ªå¯èƒ½æ¶‰åŠå¾ˆå¤šçœŸå®çš„ Perl ä»£ç ï¼ˆä¾‹å¦‚ï¼Œä¸å…è®¸åœ¨ç©ºç™½ä¹‹é—´ä½¿ç”¨ç©ºæ ¼ï¼‰ sigilå’Œå˜é‡çš„åç§°ï¼‰ï¼Œä½†æœ‰ä¸€äº›ä¸å¹¸ä¸ Perl é»‘å®¢çš„ä¹ æƒ¯ç¼–ç é£æ ¼å†²çªï¼š

åœ¨å‚æ•°åˆ—è¡¨çš„å·¦æ‹¬å·ä¹‹å‰ä¸å…è®¸æœ‰ç©ºæ ¼ã€‚

```perl
substr ($s, 4, 1); # Perl 5 (in Perl 6 this would try to pass a single 
                       #         argument of type List to substr) 
```

```perl6
substr($s, 4, 1);  # Perl 6 
substr $s, 4, 1;   # Perl 6 - alternative parentheses-less style 
```

å¦‚æœè¿™çœŸçš„æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆä½ å¯èƒ½æƒ³çœ‹çœ‹ Perl 6 ç”Ÿæ€ç³»ç»Ÿä¸­çš„ `Slang::Tuxic` æ¨¡å—ï¼šå®ƒæ”¹å˜äº† Perl 6 çš„è¯­æ³•ï¼Œä½ å¯ä»¥åœ¨å¼€æ”¾ä¹‹å‰æœ‰ä¸€ä¸ªç©ºæ ¼ å‚æ•°åˆ—è¡¨çš„æ‹¬å·ã€‚

- å…³é”®å­—åç«‹å³éœ€è¦ç©ºæ ¼

```perl
my($alpha, $beta);          # Perl 5, tries to call my() sub in Perl 6 
```

```perl6
my ($alpha, $beta);         # Perl 6 
```

```perl6
if($a < 0) { ... }          # Perl 5, dies in Perl 6 
```

```perl6
if ($a < 0) { ... }         # Perl 6 
if $a < 0 { ... }           # Perl 6, more idiomatic 
```

```perl6
while($x-- > 5) { ... }     # Perl 5, dies in Perl 6 
```

```perl6
while ($x-- > 5) { ... }    # Perl 6 
while $x-- > 5 { ... }      # Perl 6, more idiomatic 
```

- å‰ç¼€è¿ç®—ç¬¦ä¹‹åæˆ– postfix/postcircumfixè¿ç®—ç¬¦ï¼ˆåŒ…æ‹¬æ•°ç»„/æ•£åˆ—ä¸‹æ ‡ï¼‰ä¹‹å‰ä¸å…è®¸æœ‰ç©ºæ ¼ã€‚

```perl
$seen {$_} ++; # Perl 5 
```

```perl6
%seen{$_}++;   # Perl 6 
```

- ä¸­ç¼€è¿ç®—ç¬¦ä¹‹å‰æ‰€éœ€çš„ç©ºç™½ï¼Œå¦‚æœå®ƒä¸ç°æœ‰çš„ postfix/postcircumfixè¿ç®—ç¬¦å†²çªã€‚

```perl
$n<1;   # Perl 5 (in Perl 6 this would conflict with postcircumfix < >) 
```

```perl6
$n < 1; # Perl 6 
```

- ä½†æ˜¯ï¼Œåœ¨æ–¹æ³•è°ƒç”¨æœŸé—´å…è®¸ä½¿ç”¨ç©ºæ ¼ï¼

```perl
# Perl 5 
my @books = $xml
  ->parse_file($file)          # some comment 
  ->findnodes("/library/book");
```

```perl6
# Perl 6 
my @books = $xml
  .parse-file($file)           # some comment 
  .findnodes("/library/book");

```

ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨link:https://docs.perl6.org/language/syntax#Unspace[unspace]åœ¨Perl 6ä»£ç ä¸­æ·»åŠ ç©ºæ ¼ï¼Œå¦åˆ™ä¸å…è®¸è¿™æ ·åšã€‚

å¦è¯·å‚è§link:https://docs.perl6.org/language/syntax#Lexical_conventions[è¯­æ³•é¡µé¢ä¸­çš„å…¶ä»–è¯æ³•çº¦å®š]ã€‚

=== ç¬¦å·

åœ¨ Perl 5 ä¸­ï¼Œæ•°ç»„å’Œå“ˆå¸Œå€¼æ ¹æ®è®¿é—®æ–¹å¼ä½¿ç”¨æ›´æ”¹çš„ç¬¦å·ã€‚åœ¨ Perl 6 ä¸­ï¼Œæ— è®ºå˜é‡å¦‚ä½•è¢«ä½¿ç”¨ï¼Œè¿™äº›ç¬¦å·éƒ½æ˜¯ä¸å˜çš„ - æ‚¨å¯ä»¥å°†å®ƒä»¬è§†ä¸ºå˜é‡åç§°çš„ä¸€éƒ¨åˆ†ã€‚

==== $ æ ‡é‡

`$` ç¬¦å·ç°åœ¨æ€»æ˜¯ä¸â€œæ ‡é‡â€å˜é‡ï¼ˆä¾‹å¦‚ `$name`ï¼‰ä¸€èµ·ä½¿ç”¨ï¼Œè€Œä¸å†ç”¨äºlink:https://docs.perl6.org/language/5to6-nutshell#%5B%5D_Array_indexing%2Fslicing[æ•°ç»„ç´¢å¼•]å’Œlink:https://docs.perl6.org/language/5to6-nutshell#%7B%7D_Hash_indexing%2Fslicing[æ•£åˆ—ç´¢å¼•]ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‚¨ä»ç„¶å¯ä»¥ä½¿ç”¨ `$x[1]` å’Œ `$x{"foo"}`ï¼Œä½†å®ƒå°†ä½œç”¨äº `$x`ï¼Œå¯¹ç±»ä¼¼åç§°çš„ `@x` æˆ– `%x`æ²¡æœ‰å½±å“ã€‚ ç°åœ¨å¯ä»¥ä½¿ç”¨`@x[1]` å’Œ `%x{"foo"}` è®¿é—®è¿™äº›å†…å®¹ã€‚

==== @ æ•°ç»„

@ ç¬¦å·ç°åœ¨æ€»æ˜¯ä¸"æ•°ç»„"å˜é‡ä¸€èµ·ä½¿ç”¨ï¼ˆä¾‹å¦‚ `@months`ï¼Œ`@monthslink:https://docs.perl6.org/language/5to6-nutshell#%7B%7D_Hash_indexing%2Fslicing[2]`ï¼Œ`@months[2, 4]`ï¼‰ï¼Œè€Œä¸å†ç”¨äº[å€¼åˆ‡ç‰‡å“ˆå¸Œ]ã€‚

==== % æ•£åˆ—

`%` ç¬¦å·ç°åœ¨æ€»æ˜¯ä¸â€œå“ˆå¸Œâ€å˜é‡ä¸€èµ·ä½¿ç”¨ï¼ˆä¾‹å¦‚ `%calories`, `%calories<apple>`, `%calories<pear plum>`ï¼‰ï¼Œè€Œä¸å†ç”¨äºlink:https://docs.perl6.org/language/5to6-nutshell#%5B%5D_Array_indexing%2Fslicing[é”®/å€¼åˆ‡ç‰‡æ•°ç»„]ã€‚

==== Sub

`&` ç¬¦å·ç°åœ¨ä¸€ç›´ä½¿ç”¨ï¼ˆå¹¶ä¸”æ²¡æœ‰åæ–œæ çš„å¸®åŠ©ï¼‰æ¥å¼•ç”¨å‘½åå­ä¾‹ç¨‹/è¿ç®—ç¬¦çš„å‡½æ•°å¯¹è±¡è€Œä¸è°ƒç”¨å®ƒï¼Œå³ä½¿ç”¨åç§°ä½œä¸ºâ€œåè¯â€è€Œä¸æ˜¯â€œåŠ¨è¯â€ï¼š

```perl
my $sub = \&foo; # Perl 5 
```

```perl6
my $sub = &foo;  # Perl 6 
```

```perl
callback => sub { say @_ }  # Perl 5 - can't pass built-in sub directly 
```

```perl6
callback => &say            # Perl 6 - & gives "noun" form of any sub 
```

ç”±äº Perl 6 åœ¨å®Œæˆç¼–è¯‘åä¸å…è®¸åœ¨è¯æ³•èŒƒå›´å†…æ·»åŠ /åˆ é™¤ç¬¦å·ï¼Œå› æ­¤æ²¡æœ‰ç­‰æ•ˆäº Perl 5 çš„ undefï¼†foo;ï¼Œå¹¶ä¸”å°†å®šä¹‰ä¸ Perl 5 å®šä¹‰çš„ ï¼†foo æœ€æ¥è¿‘çš„ç¬¦å·::ï¼ˆ'ï¼†foo'ï¼‰ ï¼ˆä½¿ç”¨â€œåŠ¨æ€ç¬¦å·æŸ¥æ‰¾â€è¯­æ³•ï¼‰ã€‚ ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æˆ‘çš„ï¼†fooå£°æ˜ä¸€ä¸ªå¯å˜çš„å‘½åå­ä¾‹ç¨‹; ç„¶åé€šè¿‡åˆ†é…ç»™ï¼†fooåœ¨è¿è¡Œæ—¶æ›´æ”¹å…¶å«ä¹‰ã€‚

åœ¨ Perl 5 ä¸­ï¼Œä¸æ™®é€šå­è°ƒç”¨ç›¸æ¯”ï¼Œï¼†ç¬¦å·å¯ä»¥å¦å¤–ç”¨äºä»¥ç‰¹æ®Šæ–¹å¼è°ƒç”¨å­ä¾‹ç¨‹ï¼Œå…·æœ‰ç•¥å¾®ä¸åŒçš„è¡Œä¸ºã€‚ åœ¨ Perl 6 ä¸­ï¼Œè¿™äº›ç‰¹æ®Šå½¢å¼ä¸å†å¯ç”¨ï¼š

- &foo(...) ç”¨äºè§„é¿å‡½æ•°åŸå‹

åœ¨ Perl 6 ä¸­æ²¡æœ‰åŸå‹ï¼Œä¸ç®¡ä½ æ˜¯å¦ä¼ é€’ä¸€ä¸ªæ–‡å­—ä»£ç å—æˆ–ä¸€ä¸ªåŒ…å«ä»£ç å¯¹è±¡çš„å˜é‡ä½œä¸ºå‚æ•°ï¼Œå®ƒå°±ä¸å†æœ‰åŒºåˆ«äº†ï¼š

```perl
# Perl 5: 
first_index { $_ > 5 } @values;
&first_index($coderef, @values); # (disabling the prototype that parses a 
                                     # literal block as the first argument) 
```

```perl6
# Perl 6: 
first { $_ > 5 }, @values, :k;   # the :k makes first return an index 
first $coderef, @values, :k;
```

ï¼†FOO; å’Œgotoï¼†foo; é‡æ–°ä½¿ç”¨è°ƒç”¨è€…çš„å‚æ•°åˆ—è¡¨/æ›¿æ¢è°ƒç”¨å †æ ˆä¸­çš„è°ƒç”¨è€…ã€‚ Perl 6å¯ä»¥ä½¿ç”¨callameè¿›è¡Œé‡æ–°è°ƒåº¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨nextsameå’Œnextxï¼Œå®ƒä»¬åœ¨Perl 5ä¸­æ²¡æœ‰å®Œå…¨ç­‰æ•ˆã€‚

```perl
sub foo { say "before"; &bar;     say "after" } # Perl 5 
```

```perl6
sub foo { say "before"; bar(|@_); say "after" } # Perl 6 - have to be explicit 
```

```perl
sub foo { say "before"; goto &bar } # Perl 5 
```

```perl6
proto foo (|) {*};
multi foo ( Any $n ) {
    say "Any"; say $n;
};
multi foo ( Int $n ) {
    say "Int"; callsame;
};
foo(3); # /language/functions#index-entry-dispatch_callsame 
```

==== * Glob

åœ¨Perl 5ä¸­ï¼Œ`*` sigilå¼•ç”¨äº† Perl ç”¨äºå­˜å‚¨éè¯æ³•å˜é‡ï¼Œæ–‡ä»¶å¥æŸ„ï¼Œå­å’Œæ ¼å¼çš„ GLOB ç»“æ„ã€‚

å½“æ–‡ä»¶å¥æŸ„éœ€è¦ä¼ é€’ç»™å­æ–‡ä»¶æ—¶ï¼Œæ‚¨æœ€æœ‰å¯èƒ½åœ¨æ—©æœŸPerlç‰ˆæœ¬ä¸Šç¼–å†™çš„ä»£ç ä¸­é‡åˆ° GLOBï¼Œè¯¥ç‰ˆæœ¬ä¸æ”¯æŒè¯æ³•æ–‡ä»¶å¥æŸ„ã€‚

```perl
# Perl 5 - ancient method 
sub read_2 {
    local (*H) = @_;
    return scalar(<H>), scalar(<H>);
}
open FILE, '<', $path or die;
my ($line1, $line2) = read_2(*FILE);
```

åœ¨è½¬æ¢ä¸º Perl 6 ä¹‹å‰ï¼Œæ‚¨åº”è¯¥é‡æ„ Perl 5 ä»£ç ä»¥æ¶ˆé™¤å¯¹ GLOB çš„éœ€æ±‚ã€‚


```perl
# Perl 5 - modern use of lexical filehandles 
sub read_2 {
    my ($fh) = @_;
    return scalar(<$fh>), scalar(<$fh>);
}
open my $in_file, '<', $path or die;
my ($line1, $line2) = read_2($in_file);
```

è¿™é‡Œåªæ˜¯ä¸€ä¸ªå¯èƒ½çš„ Perl 6 ç¿»è¯‘ï¼š

```perl6
# Perl 6 
sub read-n($fh, $n) {
    return $fh.get xx $n;
}
my $in-file = open $path or die;
my ($line1, $line2) = read-n($in-file, 2);
```


=== æ•°ç»„ç´¢å¼•/åˆ‡ç‰‡

æ•°ç»„ä¸Šçš„ç´¢å¼•å’Œåˆ‡ç‰‡æ“ä½œä¸å†ä¼šå½±å“å˜é‡çš„ç¬¦å·ï¼Œå‰¯è¯å¯ç”¨äºæ§åˆ¶åˆ‡ç‰‡çš„ç±»å‹ï¼š

- ç´¢å¼•

```perl
say $months[2]; # Perl 5 
```

```perl6
say @months[2]; # Perl 6 - @ instead of $ 
```

- å€¼åˆ‡ç‰‡

```perl
say join ',', @months[6, 8..11]; # Perl 5 and Perl 6 
```

- é”®/å€¼åˆ‡ç‰‡

```perl6
say join ',', %months[6, 8..11];    # Perl 5 
say join ',', @months[6, 8..11]:kv; # Perl 6 - @ instead of %; use :kv adverb 
```

å¦è¯·æ³¨æ„ï¼Œä¸‹æ ‡æ–¹æ‹¬å·ç°åœ¨æ˜¯ä¸€ä¸ªæ™®é€šçš„postcircumfixè¿ç®—ç¬¦ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¥æ³•å½¢å¼ï¼Œå› æ­¤link:https://docs.perl6.org/language/5to6-nutshell#exists[æ£€æŸ¥å…ƒç´ çš„å­˜åœ¨]å’Œlink:https://docs.perl6.org/language/5to6-nutshell#delete[æœªè®¾ç½®å…ƒç´ ]æ˜¯é€šè¿‡å‰¯è¯å®Œæˆçš„ã€‚


=== {} æ•£åˆ—ç´¢å¼•/åˆ‡ç‰‡

æ•£åˆ—ä¸Šçš„ç´¢å¼•å’Œåˆ‡ç‰‡æ“ä½œä¸å†å½±å“å˜é‡çš„ç¬¦å·ï¼Œå‰¯è¯å¯ç”¨äºæ§åˆ¶åˆ‡ç‰‡çš„ç±»å‹ã€‚æ­¤å¤–ï¼Œå•å­—ä¸‹æ ‡ä¸å†åœ¨èŠ±æ‹¬å·å†…ç¥å¥‡åœ°è‡ªåŠ¨å¼•ç”¨;ç›¸åï¼Œæ–°çš„å°–æ‹¬å·ç‰ˆæœ¬å¯ç”¨ï¼Œå®ƒå§‹ç»ˆè‡ªåŠ¨å¼•ç”¨å…¶å†…å®¹ï¼ˆä½¿ç”¨ä¸ `qw` //å¼•ç”¨æ„é€ ç›¸åŒçš„è§„åˆ™ï¼‰ï¼š

- ç´¢å¼•

```perl
say $calories{"apple"}; # Perl 5 
```

```perl6
say %calories{"apple"}; # Perl 6 - % instead of $ 
```

```perl
say $calories{apple};   # Perl 5 
```

```perl6
say %calories<apple>;   # Perl 6 - angle brackets; % instead of $ 
say %caloriesÂ«"$key"Â»;  # Perl 6 - double angles interpolate as a list of Str 
```

- å€¼åˆ‡ç‰‡

```perl
say join ',', @calories{'pear', 'plum'}; # Perl 5 
```

```perl6
say join ',', %calories{'pear', 'plum'}; # Perl 6 - % instead of @ 
say join ',', %calories<pear plum>;      # Perl 6 (prettier version) 
my $keys = 'pear plum';
say join ',', %caloriesÂ«$keysÂ»;          # Perl 6 the split is done after interpolation
```

- é”®/å€¼ç´¢å¼•

```perl
say join ',', %calories{'pear', 'plum'};    # Perl 5 
```

```perl6
say join ',', %calories{'pear', 'plum'}:kv; # Perl 6 - use :kv adverb 
say join ',', %calories<pear plum>:kv;      # Perl 6 (prettier version) 
```

è¿˜è¦æ³¨æ„ï¼Œä¸‹æ ‡èŠ±æ‹¬å·ç°åœ¨æ˜¯ä¸€ä¸ªæ™®é€šçš„ postcircumfix æ“ä½œç¬¦è€Œä¸æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„è¯­æ³•å½¢å¼ï¼Œå› æ­¤æ£€æŸ¥é”®çš„å­˜åœ¨å’Œåˆ é™¤é”®æ˜¯ç”¨å‰¯è¯å®Œæˆçš„ã€‚

=== åˆ›å»ºå¼•ç”¨å¹¶ä½¿ç”¨å®ƒä»¬

åœ¨ Perl 5 ä¸­ï¼Œåœ¨åˆ›å»ºæ—¶è¿”å›å¯¹åŒ¿åæ•°ç»„å’Œæ•£åˆ—å’Œ subs çš„å¼•ç”¨ã€‚ ä½¿ç”¨\è¿ç®—ç¬¦ç”Ÿæˆå¯¹ç°æœ‰å‘½åå˜é‡å’Œ subs çš„å¼•ç”¨ã€‚ â€œå¼•ç”¨/è§£é™¤å¼•ç”¨â€è¿™ä¸ªæ¯”å–»å¹¶æ²¡æœ‰å¹²å‡€åœ°æ˜ å°„åˆ°å®é™…çš„ Perl 6 å®¹å™¨ç³»ç»Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»å…³æ³¨å¼•ç”¨è¿ç®—ç¬¦çš„æ„å›¾è€Œä¸æ˜¯å®é™…çš„è¯­æ³•ã€‚

```perl
my $aref = \@aaa  ; # Perl 5 
```

ä¾‹å¦‚ï¼Œè¿™å¯èƒ½ç”¨äºå°†å¼•ç”¨ä¼ é€’ç»™ä¾‹ç¨‹ã€‚ä½†æ˜¯åœ¨Perl 6ä¸­ï¼Œä¼ é€’äº†ï¼ˆå•ä¸ªï¼‰åº•å±‚å¯¹è±¡ï¼ˆä½ å¯ä»¥è®¤ä¸ºå®ƒæ˜¯ä¸€ç§é€šè¿‡å¼•ç”¨ä¼ é€’ï¼‰ã€‚

```perl6
my @array = 4,8,15;
{ $_[0] = 66 }(@array);   # run the block with @array aliased to $_ 
say @array; #  OUTPUT: Â«[66 8 15]Â» 
```

ä¼ é€’ `@array` çš„åŸºç¡€Arrayå¯¹è±¡ï¼Œå¹¶åœ¨å£°æ˜çš„ä¾‹ç¨‹ä¸­ä¿®æ”¹å…¶ç¬¬ä¸€ä¸ªå€¼ã€‚

åœ¨ Perl 5 ä¸­ï¼Œå–æ¶ˆå¼•ç”¨æ•´ä¸ªå¼•ç”¨çš„è¯­æ³•æ˜¯ type-sigil å’ŒèŠ±æ‹¬å·ï¼Œåœ¨èŠ±æ‹¬å·å†…å¼•ç”¨ã€‚ åœ¨ Perl 6 ä¸­ï¼Œè¿™ä¸ªæ¦‚å¿µæ ¹æœ¬ä¸é€‚ç”¨ï¼Œå› ä¸ºå‚è€ƒéšå–»å¹¶ä¸çœŸæ­£é€‚ç”¨ã€‚

åœ¨ Perl 5 ä¸­ï¼Œç®­å¤´è¿ç®—ç¬¦ `->` ç”¨äºå•ä¸ªè®¿é—®å¤åˆå¼•ç”¨æˆ–é€šè¿‡å¼•ç”¨è°ƒç”¨ subã€‚ åœ¨ Perl 6 ä¸­ï¼Œç‚¹è¿ç®—ç¬¦ã€‚ å§‹ç»ˆç”¨äºå¯¹è±¡æ–¹æ³•ï¼Œä½†å…¶ä½™æ–¹æ³•å¹¶ä¸çœŸæ­£é€‚ç”¨ã€‚

```perl
# Perl 5 
    say $arrayref->[7];
    say $hashref->{'fire bad'};
    say $subref->($foo, $bar);
```

åœ¨ç›¸å¯¹è¾ƒæ–°ç‰ˆæœ¬çš„ Perl 5ï¼ˆ5.20åŠæ›´é«˜ç‰ˆæœ¬ï¼‰ä¸­ï¼Œæ–°åŠŸèƒ½å…è®¸ä½¿ç”¨ç®­å¤´è¿ç®—ç¬¦è¿›è¡Œè§£é™¤å¼•ç”¨ï¼šè¯·å‚é˜… link:https://metacpan.org/pod/release/SHAY/perl-5.20.1/pod/perl5200delta.pod#Experimental_Postfix_Dereferencing[Postfix Dereferencing]ã€‚ è¿™å¯ä»¥ç”¨äºä»æ ‡é‡åˆ›å»ºæ•°ç»„ã€‚ æ­¤æ“ä½œé€šå¸¸ç§°ä¸º decontï¼Œå¦‚åœ¨å»åŒ…å®¹åŒ–ä¸­ï¼Œå¹¶ä¸”åœ¨Perl 6ä¸­ä½¿ç”¨è¯¸å¦‚ `.list` å’Œ `.hash` ä¹‹ç±»çš„æ–¹æ³•ï¼š

```perl
# Perl 5.20 
    use experimental qw< postderef >;
    my @a = $arrayref->@*;
    my %h = $hashref->%*;
    my @slice = $arrayref->@[3..7];
```

```perl6
# Perl 6 
    my @a = $contains-an-array.list;        # or @($arrayref) 
    my %h = $contains-a-hash.hash;          # or %($hashref) 
```

â€œZenâ€ åˆ‡ç‰‡åšåŒæ ·çš„äº‹æƒ…ï¼š

```perl6
# Perl 6 
    my @a = $contains-an-array[];
    my %h = $contains-a-hash{};
```

æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…link:https://docs.perl6.org/language/containers[æ–‡æ¡£çš„â€œå®¹å™¨â€éƒ¨åˆ†]ã€‚


=== è¿ç®—ç¬¦

æœ‰å…³æ‰€æœ‰è¿ç®—ç¬¦çš„å®Œæ•´è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…link:https://docs.perl6.org/language/operators[è¿ç®—ç¬¦æ–‡æ¡£]ã€‚

æ²¡å‘ç”Ÿå˜åŒ–çš„ï¼š

- `+` æ•°å­—åŠ æ³•  
- `-` æ•°å­—å‡æ³•  
- `*` æ•°å­—ä¹˜æ³•   
- `/` æ•°å­—é™¤æ³•  
- `%` æ•°å­—æ±‚æ¨¡  
- `**` æ•°å­—æŒ‡æ•°  
- `++` æ•°å­—é€’å¢  
- `--` æ•°å­—é€’å‡  
- `! && || ^` å¸ƒå°”ï¼Œé«˜ä¼˜å…ˆçº§  
- `not and or xor` å¸ƒå°”ï¼Œä½ä¼˜å…ˆçº§    
- `== != < > <= >=` æ•°å­—æ¯”è¾ƒ    
- `eq ne lt gt le ge` å­—ç¬¦ä¸²æ¯”è¾ƒ  

=== , (é€—å·) åˆ—è¡¨åˆ†å‰²ç¬¦

æ²¡æœ‰æ”¹å˜ï¼Œä½†è¯·æ³¨æ„ï¼Œä¸ºäº†å°†æ•°ç»„å˜é‡å±•å¹³ä¸ºåˆ—è¡¨ï¼ˆä¸ºäº†è¿½åŠ æˆ–æ·»åŠ æ›´å¤šé¡¹ç›®çš„å‰ç¼€ï¼‰ï¼Œåº”è¯¥ä½¿ç”¨|æ“ä½œå‘˜ï¼ˆå¦è§link:https://docs.perl6.org/type/Slip[Slip]ï¼‰ã€‚ä¾‹å¦‚ï¼š

```perl6
my @numbers = 100, 200, 300;
my @more_numbers = 500, 600, 700;
my @all_numbers = |@numbers, 400, |@more_numbers;
```

è¿™æ ·å°±å¯ä»¥è¿æ¥æ•°ç»„ã€‚

è¯·æ³¨æ„ï¼Œå³ä¾§ä¸éœ€è¦ä»»ä½•æ‹¬å·ï¼šList Separator è´Ÿè´£åˆ›å»ºåˆ—è¡¨ï¼Œè€Œä¸æ˜¯æ‹¬å·ï¼

==== <=> cmp ä¸‰è·¯æ¯”è¾ƒ

åœ¨ Perl 5 ä¸­ï¼Œè¿™äº›è¿ç®—ç¬¦è¿”å› -1, 0 æˆ– 1ã€‚åœ¨ Perl 6 ä¸­ï¼Œå®ƒä»¬è¿”å› `Order::Less`ï¼Œ`Order::Same` æˆ– `Order::More`ã€‚

`cmp` ç°åœ¨å‘½åä¸º `leg`; å®ƒå¼ºåˆ¶å­—ç¬¦ä¸²ä¸Šä¸‹æ–‡è¿›è¡Œæ¯”è¾ƒã€‚

`<=>` ä»ç„¶å¼ºåˆ¶æ•°å­—ä¸Šä¸‹æ–‡ã€‚

Perl 6 ä¸­çš„ `cmp` æ‰§è¡Œ `<=>` æˆ– `leg`ï¼Œå…·ä½“å–å†³äºå…¶å‚æ•°çš„ç°æœ‰ç±»å‹ã€‚

==== ~~ æ™ºèƒ½åŒ¹é…è¿ç®—ç¬¦

è™½ç„¶è¿ç®—ç¬¦æ²¡æœ‰æ”¹å˜ï¼Œä½†ç¡®åˆ‡åŒ¹é…çš„è§„åˆ™å–å†³äºä¸¤ä¸ªå‚æ•°çš„ç±»å‹ï¼Œå¹¶ä¸”è¿™äº›è§„åˆ™åœ¨ Perl 5 å’Œ Perl 6 ä¸­å¤§ä¸ç›¸åŒã€‚è¯·å‚é˜… link:https://docs.perl6.org/routine/~~[~~]å’Œ link:https://docs.perl6.org/language/operators#index-entry-smartmatch_operator[smartmatch è¿ç®—ç¬¦]ã€‚

==== & | ^ å­—ç¬¦ä¸²ä½è¿ç®—ç¬¦

==== & | ^ æ•°å­—ä½è¿ç®—ç¬¦

==== & | ^ å¸ƒå°”è¿ç®—ç¬¦


åœ¨ Perl 5 ä¸­ï¼Œ`& | ^` æ ¹æ®å‚æ•°çš„å†…å®¹è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œ`31 | 33` è¿”å›ä¸ `â€œ31â€|â€œ33â€` ä¸åŒçš„ç»“æœã€‚

åœ¨ Perl 6 ä¸­ï¼Œè¿™äº›å•å­—ç¬¦æ“ä½œå·²è¢«åˆ é™¤ï¼Œå¹¶è¢«ä¸¤ä¸ªå­—ç¬¦çš„æ“ä½œç³»ç»Ÿå–ä»£ï¼Œè¿™äº›æ“ä½œå°†ä»–ä»¬çš„å‚æ•°å¼ºåˆ¶è½¬æ¢ä¸ºæ‰€éœ€çš„ä¸Šä¸‹æ–‡ã€‚

```perl6
# Infix ops (two arguments; one on each side of the op) 
+&  +|  +^  And Or Xor: Numeric
~&  ~|  ~^  And Or Xor: String
?&  ?|  ?^  And Or Xor: Boolean
 
# Prefix ops (one argument, after the op) 
+^  Not: Numeric
~^  Not: String
?^  Not: Boolean (same as the ! op)
```

==== << >> æ•°å­—å·¦ç§»|å³ç§»è¿ç®—ç¬¦

ç”± `+<` å’Œ `+>` ä»£æ›¿ã€‚

```perl
say 42 << 3; # Perl 5 
```

```perl6
say 42 +< 3; # Perl 6 
```

==== => èƒ–é€—å·

åœ¨ Perl 5 ä¸­ï¼Œ`=>` çš„è¡Œä¸ºå°±åƒä¸€ä¸ªé€—å·ï¼Œä½†ä¹Ÿå¼•ç”¨äº†å®ƒçš„å·¦ä¾§ã€‚

åœ¨ Perl 6 ä¸­ï¼Œ`=>` æ˜¯ link:https://docs.perl6.org/type/Pair[Pair] è¿ç®—ç¬¦ï¼ŒåŸç†ä¸Šå®Œå…¨ä¸åŒï¼Œä½†åœ¨è®¸å¤šæƒ…å†µä¸‹éƒ½æ˜¯ç›¸åŒçš„ã€‚

å¦‚æœæ‚¨åœ¨å“ˆå¸Œåˆå§‹åŒ–ä¸­ä½¿ç”¨ `=>`ï¼Œæˆ–è€…å°†å‚æ•°ä¼ é€’ç»™æœŸæœ› hashref çš„ subï¼Œåˆ™ç”¨æ³•å¯èƒ½ç›¸åŒã€‚

```perl6
sub get_the_loot { ... }; # Perl 6 stub 
# Works in Perl 5 and Perl 6 
my %hash = ( AAA => 1, BBB => 2 );
get_the_loot( 'diamonds', { quiet_level => 'very', quantity => 9 }); # Note the curly braces 
```

å¦‚æœä½ ä½¿ç”¨ `=>` ä½œä¸ºä¸€ä¸ªæ–¹ä¾¿çš„å¿«æ·æ–¹å¼ï¼Œä¸å¿…å¼•ç”¨åˆ—è¡¨çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–è€…å°†å‚æ•°ä¼ é€’ç»™ä¸€ä¸ªéœ€è¦ `KEY`ï¼Œ`VALUE`ï¼Œ`KEY`ï¼Œ`VALUE` çš„å¹³é¢åˆ—è¡¨çš„å­ï¼Œé‚£ä¹ˆç»§ç»­ä½¿ç”¨ `=>` å¯èƒ½ä¼šç ´åä½ çš„ä»£ç ã€‚ æœ€ç®€å•çš„è§£å†³æ–¹æ³•æ˜¯å°†è¯¥èƒ–ç®­å¤´æ›´æ”¹ä¸ºå¸¸è§„é€—å·ï¼Œå¹¶æ‰‹åŠ¨å°†å¼•å·æ·»åŠ åˆ°å…¶å·¦ä¾§ã€‚ æˆ–è€…ï¼Œæ‚¨å¯ä»¥æ›´æ”¹ sub çš„APIä»¥link:https://docs.perl6.org/type/Signature#Slurpy_%28A.K.A._variadic%29_parameters[slurpå“ˆå¸Œ]ã€‚ ä¸€ä¸ªæ›´å¥½çš„é•¿æœŸè§£å†³æ–¹æ¡ˆæ˜¯å°†subçš„APIæ”¹ä¸ºæœŸæœ›Pairs; ä½†æ˜¯ï¼Œè¿™éœ€è¦æ‚¨ä¸€æ¬¡æ›´æ”¹æ‰€æœ‰ sub è°ƒç”¨ã€‚

```perl
# Perl 5 
sub get_the_loot {
    my $loot = shift;
    my %options = @_;
    # ... 
}
# Note: no curly braces in this sub call 
get_the_loot( 'diamonds', quiet_level => 'very', quantity => 9 );
```

```perl6
# Perl 6, original API 
sub get_the_loot( $loot, *%options ) { # The * means to slurp everything 
    ...
}
get_the_loot( 'diamonds', quiet_level => 'very', quantity => 9 ); # Note: no curly braces in this API 
 
# Perl 6, API changed to specify valid options 
# The colon before the sigils means to expect a named variable, 
# with the key having the same name as the variable. 
sub get_the_loot( $loot, :$quiet_level?, :$quantity = 1 ) {
    # This version will check for unexpected arguments! 
    ...
}
get_the_loot( 'diamonds', quietlevel => 'very' ); # Throws error for misspelled parameter name 
```

==== ?  : ä¸‰å…ƒè¿ç®—ç¬¦

æ¡ä»¶è¿ç®—ç¬¦ `? :` å·²ç»è¢«æ›¿æ¢æˆ `?? !! `ã€‚

```perl
my $result = $score > 60 ?  'Pass' :  'Fail'; # Perl 5 
```

```perl6
my $result = $score > 60 ?? 'Pass' !! 'Fail'; # Perl 6 
```

==== .(ç‚¹å·) å­—ç¬¦ä¸²è¿æ¥

æ›¿æ¢ä¸ºæ³¢æµªå·ã€‚

åŠ©è®°ï¼šæƒ³åˆ°ç”¨é’ˆå’Œçº¿å°†ä¸¤ä¸ªå­—ç¬¦ä¸²â€œæ‹¼æ¥â€åœ¨ä¸€èµ·ã€‚

```perl
$food = 'grape' . 'fruit'; # Perl 5 
```

```perl6
$food = 'grape' ~ 'fruit'; # Perl 6 
```

==== x åˆ—è¡¨å¤åˆ¶æˆ–å­—ç¬¦ä¸²å¤åˆ¶è¿ç®—ç¬¦

åœ¨ Perl 5 ä¸­ï¼Œx æ˜¯å¤åˆ¶è¿ç®—ç¬¦ï¼Œå®ƒåœ¨æ ‡é‡æˆ–åˆ—è¡¨ä¸Šä¸‹æ–‡ä¸­çš„è¡Œä¸ºæœ‰æ‰€ä¸åŒï¼š

- åœ¨æ ‡é‡ä¸Šä¸‹æ–‡ä¸­ï¼Œ`x` é‡å¤ä¸€ä¸ªå­—ç¬¦ä¸²;    
- åœ¨åˆ—è¡¨ä¸Šä¸‹æ–‡ä¸­ `x` é‡å¤ä¸€ä¸ªåˆ—è¡¨ï¼Œä½†å‰ææ˜¯å·¦å‚æ•°æ˜¯æ‹¬å·ï¼   

Perl 6 ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„å¤åˆ¶è¿ç®—ç¬¦æ¥å®ç°ä¸Šè¿°ç›®çš„ï¼š

- `x` è¡¨ç¤ºå­—ç¬¦ä¸²é‡å¤ï¼ˆåœ¨ä»»ä½•ä¸Šä¸‹æ–‡ä¸­ï¼‰;  
- `xx` è¡¨ç¤ºåˆ—è¡¨é‡å¤ï¼ˆåœ¨ä»»ä½•ä¸Šä¸‹æ–‡ä¸­ï¼‰ã€‚  

åŠ©è®°ç¬¦ï¼š`x` å¾ˆçŸ­ï¼Œ`xx` å¾ˆé•¿ï¼Œæ‰€ä»¥ `xx` æ˜¯ç”¨äºåˆ—è¡¨çš„ã€‚

```perl
# Perl 5 
    print '-' x 80;             # Print row of dashes 
    @ones = (1) x 80;           # A list of 80 1's 
    @ones = (5) x @ones;        # Set all elements to 5 
```

```perl6
# Perl 6 
    print '-' x 80;             # Unchanged 
    @ones = 1 xx 80;            # Parentheses no longer needed 
    @ones = 5 xx @ones;         # Parentheses no longer needed 
```

==== .. ... ä¸¤ä¸ªç‚¹æˆ–ä¸‰ä¸ªç‚¹ï¼ŒèŒƒå›´æ“ä½œæˆ– flipflop è¿ç®—ç¬¦

åœ¨ Perl 5 ä¸­ï¼Œ`..` æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„è¿ç®—ç¬¦ä¹‹ä¸€ï¼Œå…·ä½“å–å†³äºä¸Šä¸‹æ–‡ã€‚

åœ¨åˆ—è¡¨ä¸Šä¸‹æ–‡ä¸­ï¼Œ`..` æ˜¯ç†Ÿæ‚‰çš„èŒƒå›´è¿ç®—ç¬¦ã€‚ Perl 5 ä»£ç çš„èŒƒå›´ä¸åº”è¯¥è¦æ±‚ç¿»è¯‘ã€‚

åœ¨æ ‡é‡ä¸Šä¸‹æ–‡ä¸­ï¼Œ`..` å’Œ `...` æ˜¯é²œä¸ºäººçŸ¥çš„ Flipflop è¿ç®—ç¬¦ã€‚ å®ƒä»¬å·²è¢« `ff` å’Œ `fff` å–ä»£ã€‚

==== å­—ç¬¦ä¸²æ’å€¼

åœ¨ Perl 5 ä¸­ï¼Œ`"${foo}s"` ä»å…¶æ—è¾¹çš„å¸¸è§„æ–‡æœ¬ä¸­åˆ é™¤å˜é‡åã€‚ åœ¨ Perl 6 ä¸­ï¼Œåªéœ€å°†èŠ±æ‹¬å·æ‰©å±•ä¸ºåŒ…æ‹¬sigilï¼š`"{$foo}s"`ã€‚ äº‹å®ä¸Šï¼Œè¿™æ˜¯æ’å…¥è¡¨è¾¾å¼çš„ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ã€‚

==== å¤åˆè¯­å¥

è¿™äº›è¯­å¥åŒ…æ‹¬æ¡ä»¶å’Œå¾ªç¯ã€‚

===== æ¡ä»¶è¯­å¥

====== if elsif else unless

å¤§éƒ¨åˆ†æ²¡æœ‰å˜åŒ–; æ¡ä»¶å‘¨å›´çš„æ‹¬å·ç°åœ¨æ˜¯å¯é€‰çš„ï¼Œä½†å¦‚æœä½¿ç”¨ï¼Œåˆ™ä¸èƒ½ç«‹å³è·Ÿéšå…³é”®å­—ï¼Œå¦åˆ™å®ƒå°†è¢«è§†ä¸ºå‡½æ•°è°ƒç”¨ã€‚ å°†æ¡ä»¶è¡¨è¾¾å¼ç»‘å®šåˆ°å˜é‡ä¹Ÿæœ‰ä¸€ç‚¹ä¸åŒï¼š

```perl
if (my $x = dostuff()) {...}  # Perl 5 
```

```perl6
if dostuff() -> $x {...}      # Perl 6 
```

ï¼ˆæ‚¨ä»ç„¶å¯ä»¥åœ¨ Perl 6 ä¸­ä½¿ç”¨æˆ‘çš„è¡¨å•ï¼Œä½†å®ƒå°†æ‰©å±•åˆ°å¤–éƒ¨å—ï¼Œè€Œä¸æ˜¯å†…éƒ¨ã€‚ï¼‰

é™¤éæ¡ä»¶ä»…å…è®¸ Perl 6 ä¸­çš„å•ä¸ªå—;å®ƒä¸å…è®¸ä½¿ç”¨ elsif æˆ– else å­å¥ã€‚

====== given-when

ç»™å®šæ—¶æ„é€ ç±»ä¼¼äº `if-elsif-else` è¯­å¥é“¾æˆ–ç±»ä¼¼äºä¾‹å¦‚ `switch-case` æ„é€ ã€‚ C. å®ƒå…·æœ‰ä¸€èˆ¬ç»“æ„ï¼š

```perl6
given EXPR {
    when EXPR { ... }
    when EXPR { ... }
    default { ... }
}
```

åœ¨å…¶æœ€ç®€å•çš„å½¢å¼ä¸­ï¼Œæ„é€ å¦‚ä¸‹ï¼š

```perl6
given $value {                   # assigns $_ 
    when "a match" {             # if $_ ~~ "a match" 
        # do-something(); 
    }
    when "another match" {       # elsif $_ ~~ "another match" 
        # do-something-else(); 
    }
    default {                    # else 
        # do-default-thing(); 
    }
}
```

è¿™æ˜¯å¾ˆç®€å•çš„ï¼Œå› ä¸ºæ ‡é‡å€¼åœ¨ `when` è¯­å¥ä¸­ä¸ `$_` åŒ¹é…ï¼Œè¿™æ˜¯ç”±ç»™å®šçš„è®¾ç½®ã€‚æ›´ä¸€èˆ¬åœ°è¯´ï¼ŒåŒ¹é…å®é™…ä¸Šæ˜¯ `$_` ä¸Šçš„æ™ºèƒ½åŒ¹é…ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨æ›´å¤æ‚çš„å®ä½“ï¼ˆå¦‚regexpï¼‰è¿›è¡ŒæŸ¥æ‰¾è€Œä¸æ˜¯æ ‡é‡å€¼ã€‚

å¦è¯·å‚é˜…ä¸Šé¢çš„smartmatch opä¸Šçš„è­¦å‘Šã€‚

=== å¾ªç¯

==== while until

å¤§éƒ¨åˆ†æ²¡æœ‰å˜åŒ–;æ¡ä»¶å‘¨å›´çš„æ‹¬å·ç°åœ¨æ˜¯å¯é€‰çš„ï¼Œä½†å¦‚æœä½¿ç”¨ï¼Œåˆ™ä¸èƒ½ç«‹å³è·Ÿéšå…³é”®å­—ï¼Œå¦åˆ™å®ƒå°†è¢«è§†ä¸ºå‡½æ•°è°ƒç”¨ã€‚å°†æ¡ä»¶è¡¨è¾¾å¼ç»‘å®šåˆ°å˜é‡ä¹Ÿæœ‰ä¸€ç‚¹ä¸åŒï¼š

```perl
while (my $x = dostuff()) {...}  # Perl 5 
```

```perl6
while dostuff() -> $x {...}      # Perl 6 
```

ï¼ˆæ‚¨ä»ç„¶å¯ä»¥åœ¨ Perl 6 ä¸­ä½¿ç”¨æˆ‘çš„è¡¨å•ï¼Œä½†å®ƒå°†æ‰©å±•åˆ°å¤–éƒ¨å—ï¼Œè€Œä¸æ˜¯å†…éƒ¨ã€‚ï¼‰

è¯·æ³¨æ„ï¼Œä»æ–‡ä»¶å¥æŸ„é€è¡Œè¯»å–å·²æ›´æ”¹ã€‚

åœ¨ Perl 5 ä¸­ï¼Œå®ƒæ˜¯ä½¿ç”¨è±å½¢è¿ç®—ç¬¦åœ¨whileå¾ªç¯ä¸­å®Œæˆçš„ã€‚ä½¿ç”¨forè€Œä¸æ˜¯whileæ˜¯ä¸€ä¸ªå¸¸è§çš„é”™è¯¯ï¼Œå› ä¸ºforä¼šå¯¼è‡´æ•´ä¸ªæ–‡ä»¶ç«‹å³è¢«å¸å…¥ï¼Œä»è€Œæ·¹æ²¡äº†ç¨‹åºçš„å†…å­˜ä½¿ç”¨æƒ…å†µã€‚

åœ¨ Perl 6 ä¸­ï¼Œ`for` è¯­å¥æ˜¯**æƒ°æ€§**çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ `.lines` æ–¹æ³•åœ¨ `for` å¾ªç¯ä¸­é€è¡Œè¯»å–ã€‚

```perl
while (<IN_FH>)  { } # Perl 5 
```

```perl6
for $IN_FH.lines { } # Perl 6 
```

å¦è¯·æ³¨æ„ï¼Œåœ¨ Perl 6 ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼š chomp è¡Œã€‚

==== do while/until

```perl
# Perl 5 
do {
    ...
} while $x < 10;
 
do {
    ...
} until $x >= 10;
```

è¯¥æ„é€ ä»ç„¶å­˜åœ¨ï¼Œä½†æ˜¯ `do` è¢«é‡å‘½åä¸º `repeat`ï¼Œä»¥æ›´å¥½åœ°è¡¨ç¤ºæ„é€ çš„ä½œç”¨ï¼š

```perl6
# Perl 6 
repeat {
    ...
} while $x < 10;
 
repeat {
    ...
} until $x >= 10;
```

==== for foreach

é¦–å…ˆè¦æ³¨æ„å…³äº `for` å’Œ `foreach` å…³é”®å­—çš„è¿™ç§å¸¸è§è¯¯è§£ï¼šè®¸å¤šç¨‹åºå‘˜è®¤ä¸ºä»–ä»¬åŒºåˆ†Cé£æ ¼çš„ä¸‰è¡¨è¾¾å½¢å¼å’Œåˆ—è¡¨è¿­ä»£å™¨å½¢å¼;ä»–ä»¬ä¸ï¼äº‹å®ä¸Šï¼Œå…³é”®è¯æ˜¯å¯ä»¥äº’æ¢çš„; Perl 5 ç¼–è¯‘å™¨åœ¨æ‹¬å·ä¸­æŸ¥æ‰¾åˆ†å·ä»¥ç¡®å®šè¦è§£æçš„å¾ªç¯ç±»å‹ã€‚

C é£æ ¼çš„ä¸‰å› å­å½¢å¼ç°åœ¨ä½¿ç”¨ `loop` å…³é”®å­—ï¼Œå¦åˆ™ä¿æŒä¸å˜ã€‚æ‹¬å·ä»ç„¶æ˜¯å¿…éœ€çš„ã€‚

```perl
for  ( my $i = 1; $i <= 10; $i++ ) { ... } # Perl 5 
```

```perl6
loop ( my $i = 1; $i <= 10; $i++ ) { ... } # Perl 6
```

å¾ªç¯è¿­ä»£å™¨è¡¨å•ä»¥Perl 6å‘½åï¼Œforeachä¸å†æ˜¯å…³é”®å­—ã€‚ forå¾ªç¯å…·æœ‰ä»¥ä¸‹è§„åˆ™ï¼š

- æ‹¬å·æ˜¯å¯é€‰çš„;  
- è¿­ä»£å˜é‡ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰å·²ç»ä»åˆ—è¡¨å‰é¢å‡ºç°ï¼Œå†å‡ºç°åœ¨åˆ—è¡¨å’Œæ·»åŠ çš„ç®­å¤´æ“ä½œç¬¦ä¹‹å;  
- è¿­ä»£å˜é‡ç°åœ¨æ€»æ˜¯è¯æ³•çš„ï¼š`my` æ—¢ä¸éœ€è¦ä¹Ÿä¸å…è®¸;  
- è¿­ä»£å˜é‡æ˜¯å½“å‰åˆ—è¡¨å…ƒç´ çš„åªè¯»åˆ«åï¼ˆåœ¨ Perl 5 ä¸­å®ƒæ˜¯ä¸€ä¸ªè¯»å†™åˆ«åï¼ï¼‰ã€‚å¦‚æœéœ€è¦è¯»å†™åˆ«åï¼Œè¯·å°†è¿­ä»£å˜é‡å‰é¢çš„ `->` æ›´æ”¹ä¸º `<->`ã€‚ä» Perl 5 è¿›è¡Œç¿»è¯‘æ—¶ï¼Œæ£€æŸ¥å¾ªç¯å˜é‡çš„ä½¿ç”¨ä»¥ç¡®å®šæ˜¯å¦éœ€è¦è¯»å†™ã€‚

```perl
for my $car (@cars)  {...} # Perl 5; read-write 
```

```perl6
for @cars  -> $car   {...} # Perl 6; read-only 
for @cars <-> $car   {...} # Perl 6; read-write 
```

å¦‚æœæ­£åœ¨ä½¿ç”¨é»˜è®¤ä¸»é¢˜ `$_`ï¼Œé‚£ä¹ˆå®ƒä¹Ÿæ˜¯è¯»å†™çš„ã€‚

```perl
for (@cars)      {...} # Perl 5; $_ is read-write 
```

```perl6
for @cars        {...} # Perl 6; $_ is read-write 
for @cars <-> $_ {...} # Perl 6; $_ is also read-write 
```

åœ¨æ¯æ¬¡è¿­ä»£ä¸­å¯ä»¥ä½¿ç”¨åˆ—è¡¨ä¸­å¤šä¸ªå…ƒç´ ï¼Œåªéœ€åœ¨ç®­å¤´æ“ä½œç¬¦åæŒ‡å®šå¤šä¸ªå˜é‡ï¼š

```perl6
my @array = 1..10;
for @array -> $first, $second {
    say "First is $first, second is $second";
}
```

==== each

è¿™æ˜¯ Perl 5 çš„ `whileâ€¦each(%hash) or whileâ€¦each(@array)` çš„ç­‰ä»·ç‰©ï¼Œï¼ˆå³è¿­ä»£æ•°æ®ç»“æ„çš„é”®/ç´¢å¼•å’Œå€¼ï¼‰è€Œ Perl 6 ä¸­ï¼š

```perl
while (my ($i, $v) = each(@array)) { ... } # Perl 5 
```

```perl6
for @array.kv -> $i, $v { ... } # Perl 6 
```

```perl
while (my ($k, $v) = each(%hash)) { ... } # Perl 5 
```

```perl6
for %hash.kv -> $k, $v { ... } # Perl 6 
```

==== æ§åˆ¶æµè¯­å¥

æ²¡å‘ç”Ÿå˜åŒ–çš„ï¼š

- next  
- last  
- redo  

===== continue

ä¸å†æœ‰ `continue` å—äº†ã€‚è€Œæ˜¯åœ¨å¾ªç¯ä½“å†…ä½¿ç”¨ `NEXT` å—ï¼ˆphaserï¼‰ã€‚

```perl
# Perl 5 
    my $str = '';
    for (1..5) {
        next if $_ % 2 == 1;
        $str .= $_;
    }
    continue {
        $str .= ':'
    }
```

```perl6
# Perl 6 
    my $str = '';
    for 1..5 {
        next if $_ % 2 == 1;
        $str ~= $_;
        NEXT {
            $str ~= ':'
        }
    }
```

è¯·æ³¨æ„ï¼Œphasers å¹¶ä¸éœ€è¦å—ã€‚å½“æ‚¨ä¸æƒ³è¦å¦ä¸€ä¸ªä½œç”¨åŸŸæ—¶ï¼Œè¿™éå¸¸æ–¹ä¾¿ï¼š

```perl6
# Perl 6 
    my $str = '';
    for 1..5 {
        next if $_ % 2 == 1;
        $str ~= $_;
        NEXT $str ~= ':';
    }
```

=== å‡½æ•°

==== å¸¦æœ‰è£¸å—çš„å†…ç½®å‡½æ•°

ä¹‹å‰æ¥å—è£¸å—çš„å†…ç½®å‡½æ•°ï¼Œå…¶åæ²¡æœ‰é€—å·ï¼Œå…¶ä½™å‚æ•°ç°åœ¨éœ€è¦åœ¨å—å’Œå‚æ•°ä¹‹é—´ä½¿ç”¨é€—å·ï¼Œä¾‹å¦‚ `map`ï¼Œ`grep` ç­‰ã€‚

```perl
my @results = grep { $_ eq "bars" } @foo; # Perl 5 
```

```perl6
my @results = grep { $_ eq "bars" }, @foo; # Perl 6 
```

==== delete

å˜æˆäº† link:https://docs.perl6.org/language/5to6-nutshell#%7B%7D_Hash_indexing%2Fslicing[{} å“ˆå¸Œä¸‹æ ‡]å’Œlink:https://docs.perl6.org/language/5to6-nutshell#%5B%5D_Array_indexing%2Fslicing[[]æ•°ç»„ä¸‹æ ‡]è¿ç®—ç¬¦çš„å‰¯è¯ã€‚

```perl
my $deleted_value = delete $hash{$key};  # Perl 5 
```

```perl6
my $deleted_value = %hash{$key}:delete;  # Perl 6 - use :delete adverb 
```

```perl
my $deleted_value = delete $array[$i];  # Perl 5 
```

```perl6
my $deleted_value = @array[$i]:delete;  # Perl 6 - use :delete adverb 
```

==== exists

å˜æˆäº† link:https://docs.perl6.org/language/5to6-nutshell#%7B%7D_Hash_indexing%2Fslicing[{} å“ˆå¸Œä¸‹æ ‡]å’Œlink:https://docs.perl6.org/language/5to6-nutshell#%5B%5D_Array_indexing%2Fslicing[[]æ•°ç»„ä¸‹æ ‡]è¿ç®—ç¬¦çš„å‰¯è¯ã€‚

```perl
say "element exists" if exists $hash{$key};  # Perl 5 
```

```perl6
say "element exists" if %hash{$key}:exists;  # Perl 6 - use :exists adverb 
```

```perl
say "element exists" if exists $array[$i];  # Perl 5 
```

```perl6
say "element exists" if @array[$i]:exists;  # Perl 6 - use :exists adverb
```

=== æ­£åˆ™è¡¨è¾¾å¼ (regex/regexp)

==== =~ å’Œ !~ å˜æˆäº† ~~ å’Œ !~~

åœ¨ Perl 5 ä¸­ï¼Œä½¿ç”¨ `=~` æ­£åˆ™è¡¨è¾¾å¼ç»‘å®šè¿ç®—ç¬¦å¯¹å˜é‡è¿›è¡ŒåŒ¹é…å’Œæ›¿æ¢ã€‚

åœ¨ Perl 6 ä¸­ï¼Œä½¿ç”¨äº† `~~` æ™ºèƒ½åŒ¹é…è¿ç®—ç¬¦ã€‚

```perl
next if $line  =~ /static/  ; # Perl 5 
```

```perl6
next if $line  ~~ /static/  ; # Perl 6 
```

```perl
next if $line  !~ /dynamic/ ; # Perl 5 
```

```perl6
next if $line !~~ /dynamic/ ; # Perl 6 
```

```perl
$line =~ s/abc/123/;          # Perl 5 
```

```perl6
$line ~~ s/abc/123/;          # Perl 6
```

æˆ–è€…ï¼Œå¯ä»¥ä½¿ç”¨æ–°çš„ `.match` å’Œ `.subst` æ–¹æ³•ã€‚è¯·æ³¨æ„ï¼Œlink:https://docs.perl6.org/routine/subst[.substæ˜¯éå¯å˜çš„]ã€‚

==== æ•è·ä» 0 å¼€å§‹è€Œéä» 1 å¼€å§‹

```perl
/(.+)/ and print $1; # Perl 5 
```

```perl6
/(.+)/ and print $0; # Perl 6 
```

==== ç§»åŠ¨ä¿®é¥°ç¬¦

å°†ä»»ä½•ä¿®é¥°ç¬¦ä»æ­£åˆ™è¡¨è¾¾å¼çš„æœ«å°¾ç§»åŠ¨åˆ°å¼€å¤´ã€‚è¿™å¯èƒ½éœ€è¦æ‚¨åœ¨ `/abc/` è¿™æ ·çš„æ™®é€šåŒ¹é…ä¸Šæ·»åŠ å¯é€‰çš„ `m`ã€‚

```perl
next if $line =~    /static/i ; # Perl 5 
```

```perl6
next if $line ~~ m:i/static/  ; # Perl 6 
```

==== æ·»åŠ  :P5 æˆ– :Perl5 å‰¯è¯

å¦‚æœå®é™…çš„æ­£åˆ™è¡¨è¾¾å¼å¾ˆå¤æ‚ï¼Œæ‚¨å¯èƒ½å¸Œæœ›é€šè¿‡æ·»åŠ  `P5` ä¿®é¥°ç¬¦æ¥åŸæ ·ä½¿ç”¨å®ƒã€‚

```perl
next if $line =~    m/[aeiou]/   ; # Perl 5 
```

```perl6
next if $line ~~ m:P5/[aeiou]/   ; # Perl 6, using P5 modifier 
next if $line ~~ m/  <[aeiou]> / ; # Perl 6, native new syntax 
```

è¯·æ³¨æ„ï¼ŒPerl 5 æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•å¯ä»¥è¿½æº¯åˆ°å¾ˆå¤šå¹´å‰ï¼Œå¯èƒ½ç¼ºå°‘è‡ª Perl 6 é¡¹ç›®å¼€å§‹ä»¥æ¥æ·»åŠ çš„åŠŸèƒ½ã€‚

==== ç‰¹æ®ŠåŒ¹é…å™¨é€šå¸¸å±äº <> è¯­æ³•

Perl 5 æ­£åˆ™è¡¨è¾¾å¼æ”¯æŒè®¸å¤šç‰¹æ®ŠåŒ¹é…è¯­æ³•çš„æƒ…å†µã€‚å®ƒä»¬ä¸ä¼šå…¨éƒ¨åˆ—åœ¨è¿™é‡Œï¼Œä½†é€šå¸¸ä¸æ˜¯è¢« `()` åŒ…å›´ï¼Œæ–­è¨€å°†è¢« `<>` åŒ…å›´ç€ã€‚

å¯¹äºå­—ç¬¦ç±»ï¼Œè¿™æ„å‘³ç€ï¼š

- `[abc]` å˜æˆäº† `<[abc]>`  
- `[^abc]` å˜æˆäº† `<-[abc]>`    
- `[a-zA-Z]` å˜æˆäº† `<[a..zA..Z]>`  
- `[[:upper:]]`å˜æˆäº† `<:Upper>`  
- `[abc[:upper:]]` å˜æˆäº† `<[abc]+:Upper>`  


å¯¹äºç¯è§†æ–­è¨€ï¼š

- `(?=[abc])` å˜æˆäº† `<?[abc]>`  
- `(?=ar?bitrary* pattern)` å˜æˆäº† `<before ar?bitrary* pattern>`  
- `(?!=[abc])` å˜æˆäº† `<![abc]>`  
- `(?!=ar?bitrary* pattern)` å˜æˆäº† `<!before ar?bitrary* pattern>`  
- `(?<=ar?bitrary* pattern)` å˜æˆäº† `<after ar?bitrary* pattern>`  
- `(?<!ar?bitrary* pattern)` å˜æˆäº† `<!after ar?bitrary* pattern>`  


æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…link:https://docs.perl6.org/language/regexes#Lookahead_assertions_%3C%3Fbefore_pattern%3E[å‘å‰æŸ¥çœ‹æ–­è¨€]ã€‚

ï¼ˆå’Œ <> è¯­æ³•æ— å…³, â€œç¯è§†â€ `/foo\Kbar/` å˜æˆäº† `/foo <( bar )> /`ï¼‰

- `(?(?{condition))yes-pattern|no-pattern)` å˜æˆäº† `[ <?{condition}> yes-pattern | no-pattern ]`  

==== æœ€é•¿ token åŒ¹é…(LTM) å–ä»£äº†å¤‡é€‰åˆ†æ”¯

åœ¨ Perl 6 æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œ`|` éµå¾ª LTMï¼Œå®ƒæ ¹æ®ä¸€ç»„è§„åˆ™å†³å®šå“ªä¸ªå¤‡é€‰åˆ†æ”¯èµ¢å¾—äº†ä¸€ä¸ªæ¨¡ç³ŠåŒ¹é…ï¼Œè€Œä¸æ˜¯å…ˆå†™å‡ºå“ªä¸ªã€‚

è§£å†³è¿™ä¸ªé—®é¢˜æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯åœ¨ä½ çš„ Perl 5 æ­£åˆ™è¡¨è¾¾å¼ä¸­æŠŠä»»ä½• `|` æ›´æ”¹ä¸º `||`ã€‚

ä½†æ˜¯ï¼Œå¦‚æœæ­£åˆ™è¡¨è¾¾å¼ç”¨ `||` å†™çš„æ˜¯ç»§æ‰¿æˆ–ç»„æˆä½¿ç”¨ `|` çš„è¯­æ³•æ— è®ºæ˜¯è®¾è®¡è¿˜æ˜¯æ‹¼å†™é”™è¯¯ï¼Œç»“æœå¯èƒ½æ— æ³•æŒ‰é¢„æœŸå·¥ä½œã€‚å› æ­¤ï¼Œå½“åŒ¹é…è¿‡ç¨‹å˜å¾—å¤æ‚æ—¶ï¼Œæ‚¨æœ€ç»ˆéœ€è¦å¯¹ä¸¤è€…éƒ½æœ‰æ‰€äº†è§£ï¼Œå°¤å…¶æ˜¯ LTM ç­–ç•¥çš„å·¥ä½œåŸç†ã€‚æ­¤å¤–ï¼Œ`|  å¯èƒ½æ˜¯è¯­æ³•é‡ç”¨çš„æ›´å¥½é€‰æ‹©ã€‚


==== å‘½åæ•è·

è¿™äº›å·¥ä½œæ–¹å¼ç•¥æœ‰ä¸åŒ;ä»–ä»¬ä¹Ÿåªä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ Perl 5ã€‚

```perl
use v5.22;
"Ã¾or is mighty" =~ /is (?<iswhat>\w+)/n;
say $+{iswhat};
```

éæ•è·ç»„ä¸­çš„å†…å®¹ç”¨äºå®ç°æ•è·åé¢çš„å†…å®¹ï¼Œç›´åˆ°ç»„çš„æœ«å°¾ï¼ˆtheï¼‰ã€‚æ•è·è½¬åˆ°å¸¦æœ‰æ•è·åç§°çš„é”®ä¸‹çš„ `%+` å“ˆå¸Œã€‚åœ¨ Perl 6 ä¸­ï¼Œlink:https://docs.perl6.org/language/regexes#Capturing_groups[å‘½åæ•è·ä»¥è¿™ç§æ–¹å¼å·¥ä½œ]

```perl6
"Ã¾or is mighty" ~~ /is \s+ $<iswhat>=(\w+)/;
say $<iswhat>;
```

åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­è¿›è¡Œå®é™…èµ‹å€¼;è¿™ä¸ç”¨äºå¤–éƒ¨å˜é‡çš„è¯­æ³•ç›¸åŒã€‚

==== æ³¨é‡Š

ä¸ Perl 5 ä¸€æ ·ï¼Œæ³¨é‡Šåœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ç…§å¸¸å·¥ä½œã€‚

```perl6
/ word #`(match lexical "word") / 
```

=== BEGIN, UNITCHECK, CHECK, INIT å’Œ END

é™¤äº† `UNITCHECK` ä¹‹å¤–ï¼Œæ‰€æœ‰è¿™äº›ç‰¹æ®Šå—ä¹Ÿå­˜åœ¨äº Perl 6 ä¸­ã€‚åœ¨ Perl 6 ä¸­ï¼Œè¿™äº›è¢«ç§°ä¸º link:https://docs.perl6.org/language/phasers[Phasers]ã€‚ä½†æ˜¯æœ‰ä¸€äº›å·®å¼‚ï¼

==== UNITCHECK å˜ä¸º CHECK

Perl 6 ä¸­ç›®å‰æ²¡æœ‰ç›´æ¥ç­‰æ•ˆçš„ `CHECK` å—ã€‚Perl 6 ä¸­çš„ `CHECK` phaser ä¸ Perl 5 ä¸­çš„ `UNITCHECK` å—å…·æœ‰ç›¸åŒçš„è¯­ä¹‰ï¼šåªè¦å®ƒå‡ºç°çš„ç¼–è¯‘å•å…ƒå®Œæˆè§£æï¼Œå®ƒå°±ä¼šè¿è¡Œã€‚è¿™è¢«è®¤ä¸ºæ˜¯æ¯” Perl 5 ä¸­ `CHECK` å—çš„å½“å‰è¯­ä¹‰æ›´åŠ ç†æ™ºçš„è¯­ä¹‰ã€‚ä½†å‡ºäºå…¼å®¹æ€§åŸå› ï¼Œä¸å¯èƒ½åœ¨ Perl 5 ä¸­æ›´æ”¹ `CHECK` å—çš„è¯­ä¹‰ï¼Œå› æ­¤åœ¨ 5.10 ä¸­å¼•å…¥äº† `UNITCHECK` å—ã€‚å› æ­¤å†³å®š Perl 6 `CHECK` phaser å°†éµå¾ªæ›´å¥å…¨çš„ Perl 5 `UNITCHECK` è¯­ä¹‰ã€‚

==== ä¸å†éœ€è¦å—

åœ¨ Perl 5 ä¸­ï¼Œè¿™äº›ç‰¹æ®Šå—å¿…é¡»å…·æœ‰èŠ±æ‹¬å·ï¼Œè¿™æ„å‘³ç€å•ç‹¬çš„èŒƒå›´ã€‚åœ¨ Perl 6 ä¸­ï¼Œè¿™ä¸æ˜¯å¿…éœ€çš„ï¼Œå…è®¸è¿™äº›ç‰¹æ®Šå—ä¸å‘¨å›´çš„è¯æ³•èŒƒå›´å…±äº«å®ƒä»¬çš„èŒƒå›´ã€‚

```perl
my $foo;             # Perl 5 
BEGIN { $foo = 42 }
```

```perl6
BEGIN my $foo = 42;  # Perl 6 
```

==== å…³äºé¢„ç¼–è¯‘æ”¹å˜äº†è¯­ä¹‰

å¦‚æœå°†å…¶æ”¾åœ¨æ­£åœ¨é¢„ç¼–è¯‘çš„æ¨¡å—ä¸­ï¼Œåˆ™è¿™äº›æ­¥éª¤å°†ä»…åœ¨é¢„ç¼–è¯‘æœŸé—´æ‰§è¡Œï¼Œè€Œä¸æ˜¯åœ¨åŠ è½½é¢„ç¼–è¯‘æ¨¡å—æ—¶æ‰§è¡Œã€‚ å› æ­¤ï¼Œå½“ä» Perl 5 ç§»æ¤æ¨¡å—ä»£ç æ—¶ï¼Œæ‚¨å¯èƒ½éœ€è¦æ›´æ”¹ `BEGIN` å’Œ `CHECK`ã€‚

=== ç¼–è¯‘æŒ‡ä»¤

==== strict

ä¸¥æ ¼æ¨¡å¼ç°åœ¨é»˜è®¤å¯ç”¨ã€‚

==== warnings

è­¦å‘Šç°åœ¨é»˜è®¤å¼€å¯ã€‚

ç›®å‰ `no warnings` link:https://docs.perl6.org/language/glossary#NYI[è¿˜æœªå®ç°] ï¼Œä½†æ˜¯æŠŠä¸œè¥¿æ”¾åœ¨ä¸€ä¸ªå®‰é™çš„ `{}` ä¸­ä¼šè®©å…¶æ²‰é»˜ã€‚

==== autodie

ç”± `autodie` æ›´æ”¹ä»¥åœ¨å¼‚å¸¸æ—¶æŠ›å‡ºå¼‚å¸¸çš„å‡½æ•°ç°åœ¨é€šå¸¸é»˜è®¤è¿”å› `Failures`ã€‚æ‚¨å¯ä»¥æ¯«æ— é—®é¢˜åœ°æµ‹è¯•å¤±è´¥çš„å®šä¹‰/çœŸå®æ€§ã€‚å¦‚æœä»¥ä»»ä½•å…¶ä»–æ–¹å¼ä½¿ç”¨ `Failure`ï¼Œåˆ™å°†æŠ›å‡ºç”± `Failure` å°è£…çš„ `Exception`ã€‚

```perl
# Perl 5 
open my $i_fh, '<', $input_path;  # Fails silently on error 
use autodie;
open my $o_fh, '>', $output_path; # Throws exception on error 
```

```perl6
# Perl 6 
my $i_fh = open $input_path,  :r; # Returns Failure on error 
my $o_fh = open $output_path, :w; # Returns Failure on error 
```

å› ä¸ºæ‚¨å¯ä»¥æ¯«æ— é—®é¢˜åœ°æ£€æŸ¥çœŸå®æ€§ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥åœ¨ `if` è¯­å¥ä¸­ä½¿ç”¨ `open` çš„ç»“æœï¼š

```perl6
# Perl 6 
if open($input_path,:r) -> $handle {
    .say for $handle.lines;
}
else {
    # gracefully handle the fact that the open() failed 
}
```

==== base, parent

åœ¨ç±»å£°æ˜ä¸­ï¼Œ`is` å…³é”®å­—åœ¨ Perl 6 ä¸­æ›¿æ¢äº† `use base` å’Œ `use parent`ã€‚

```perl
# Perl 5 
package Cat;
use base qw(Animal);
```

```perl6
# Perl 6 
class Cat is Animal {}
```

è¯·æ³¨æ„ï¼Œå¿…é¡»åœ¨ç¼–è¯‘æ—¶çŸ¥é“ `Animal` ç±»æ‰èƒ½ç»§æ‰¿å®ƒã€‚


==== bigint bignum bigrat

ä¸å†ç›¸å…³ã€‚

`Int` ç°åœ¨æ˜¯ä»»æ„ç²¾åº¦ï¼Œå› ä¸º `Rat` çš„åˆ†å­ï¼ˆåˆ†æ¯é™åˆ¶ä¸º `2**64`ï¼Œä¹‹åå®ƒå°†è‡ªåŠ¨å‡çº§åˆ° `Num` ä»¥ä¿æŒæ€§èƒ½ï¼‰ã€‚å¦‚æœä½ æƒ³è¦ä¸€ä¸ªå…·æœ‰ä»»æ„ç²¾åº¦åˆ†æ¯çš„ `Rat`ï¼Œå¯ä»¥ä½¿ç”¨ `FatRat`ã€‚

==== constant

åœ¨ Perl 6 ä¸­ï¼Œ`constant` æ˜¯å˜é‡çš„å£°æ˜ç¬¦ï¼Œå°±åƒ `my` ä¸€æ ·ï¼Œé™¤äº†å˜é‡æ°¸ä¹…é”å®šåˆ°å…¶åˆå§‹åŒ–è¡¨è¾¾å¼çš„ç»“æœï¼ˆåœ¨ç¼–è¯‘æ—¶è®¡ç®—ï¼‰ã€‚

æ‰€ä»¥ï¼Œå°† `=>` æ›´æ”¹ä¸º `=`ã€‚

```perl
use constant DEBUG => 0; # Perl 5 
```

```perl6
constant DEBUG = 0;      # Perl 6 
```

```perl
use constant pi => 4 * atan2(1, 1); # Perl 5 
```

```perl6
tau, pi, e, i; # built-in constants in Perl 6 
Ï„, Ï€, ğ‘’        # and their unicode equivalents 
```

==== ç¼–ç 

å…è®¸æ‚¨ä»¥é ascii æˆ–é utf8 ç¼–å†™è„šæœ¬ã€‚ Perl 6 ç›®å‰ä»…ä½¿ç”¨ utf8 ä½œä¸ºå…¶è„šæœ¬ã€‚

==== æ•´æ•°

Perl pragma ä½¿ç”¨æ•´æ•°è¿ç®—è€Œä¸æ˜¯æµ®ç‚¹è¿ç®—ã€‚åœ¨ Perl 6 ä¸­æ²¡æœ‰è¿™æ ·çš„ç­‰ä»·ç‰©ã€‚å¦‚æœä½ åœ¨è®¡ç®—ä¸­ä½¿ç”¨åŸç”Ÿæ•´æ•°ï¼Œé‚£ä¹ˆè¿™å°†æ˜¯æœ€æ¥è¿‘çš„äº‹æƒ…ã€‚

```perl6
my int $foo = 42;
my int $bar = 666;
say $foo * $bar;    # uses native integer multiplication 
```

==== lib

å¤„ç†åœ¨ç¼–è¯‘æ—¶æŸ¥æ‰¾æ¨¡å—çš„ä½ç½®ã€‚åº•å±‚é€»è¾‘ä¸ Perl 5 **éå¸¸**ä¸åŒï¼Œä½†åœ¨ä½¿ç”¨ç­‰æ•ˆè¯­æ³•çš„æƒ…å†µä¸‹ï¼Œåœ¨ Perl 6 ä¸­ `use lib` ä¸ Perl 5 ä¸­çš„ç›¸åŒã€‚

==== mro

ä¸å†ç›¸å…³ã€‚

åœ¨ Perl 6 ä¸­ï¼Œæ–¹æ³•è°ƒç”¨ç°åœ¨å§‹ç»ˆä½¿ç”¨ C3 æ–¹æ³•è§£æé¡ºåºã€‚å¦‚æœéœ€è¦æŸ¥æ‰¾ç»™å®šç±»çš„çˆ¶ç±»ï¼Œå¯ä»¥è¿™æ ·è°ƒç”¨ `mro` å…ƒæ–¹æ³•ï¼š

```perl6
say Animal.^mro;    # .^ indicates calling a meta-method on the object 
```

==== uft8

ä¸å†ç›¸å…³ï¼šåœ¨ Perl 6 ä¸­ï¼Œæºä»£ç åº”è¯¥é‡‡ç”¨ utf8 ç¼–ç ã€‚

==== vars


åœ¨ Perl 5 ä¸­ä¸é¼“åŠ±ä½¿ç”¨ã€‚ å‚é˜… link:https://perldoc.perl.org/vars.html[https://perldoc.perl.org/vars.html]ã€‚

åœ¨è½¬æ¢ä¸º Perl 6 ä¹‹å‰ï¼Œæ‚¨åº”è¯¥é‡æ„ Perl 5 ä»£ç ä»¥æ¶ˆé™¤ `use vars` çš„éœ€è¦ã€‚

=== å‘½ä»¤è¡Œæ ‡è®°

è¯·å‚é˜… link:https://github.com/rakudo/rakudo/wiki/Running-rakudo-from-the-command-line[Rakudo ä½¿ç”¨çš„å‘½ä»¤è¡Œæ ‡è®°]

ä¸å˜çš„ï¼š

-c -e -h -I -n -p -v -V

- -a    

æ›´æ”¹æ‚¨çš„ä»£ç ä»¥æ‰‹åŠ¨ä½¿ç”¨ `.split`ã€‚

- -F   

æ›´æ”¹æ‚¨çš„ä»£ç ä»¥æ‰‹åŠ¨ä½¿ç”¨ `.split`ã€‚  


- -l  

ç°åœ¨è¿™æ˜¯é»˜è®¤è¡Œä¸ºã€‚

- -M -m  

åªæœ‰ `-M` ä»ç„¶å­˜åœ¨ã€‚è€Œä¸”ï¼Œç”±äºæ‚¨ä¸èƒ½å†ä½¿ç”¨â€œno Moduleâ€è¯­æ³•ï¼Œå› æ­¤ä¸å†ä½¿ç”¨å¸¦æœ‰ `-` çš„ `-M` æ¥ â€œnoâ€ æ¨¡å—ã€‚

- -E  

ç”±äºå·²å¯ç”¨æ‰€æœ‰åŠŸèƒ½ï¼Œå› æ­¤åªéœ€ä½¿ç”¨å°å†™ `-e`ã€‚


- -d, -dt, -d:foo, -D, etc.   

æ›¿æ¢ä¸º `++BUG` metasyntactic é€‰é¡¹ã€‚


- -s  

åˆ‡æ¢è§£æç°åœ¨ç”± MAIN å­ä¾‹ç¨‹çš„å‚æ•°åˆ—è¡¨å®Œæˆã€‚

```perl
# Perl 5 
    #!/usr/bin/perl -s 
    if ($xyz) { print "$xyz\n" }
./example.pl -xyz=5
5
```

```perl6
# Perl 6 
    sub MAIN( Int :$xyz ) {
        say $xyz if $xyz.defined;
    }
```

```shell
perl6 example.p6 --xyz=5
5
perl6 example.p6 -xyz=5
5
```

- it  

è¢«ç§»é™¤äº†

- -P -u -U -W -X  

è¢«ç§»é™¤äº†ï¼Œå‚é˜… link:https://design.perl6.org/S19.html#Removed_Syntactic_Features[S19#Removed Syntactic Features.]

- -w  

ç°åœ¨æ˜¯é»˜è®¤è¡Œä¸ºã€‚

- -s, -T  

è¿™å·²è¢«æ·˜æ±°ã€‚ link:https://www.reddit.com/r/perl6/comments/718z4o/taint_mode_for_perl_6/[Reddit è®¨è®ºäº†å‡ ç§å¤åˆ¶â€œæ±¡ç‚¹â€æ¨¡å¼çš„æ–¹æ³•]ã€‚

=== æ–‡ä»¶ç›¸å…³çš„è¿ç®—ç¬¦

==== å°†æ–‡æœ¬æ–‡ä»¶çš„è¡Œè¯»å…¥æ•°ç»„

åœ¨ Perl 5 ä¸­ï¼Œè¯»å–æ–‡æœ¬æ–‡ä»¶è¡Œçš„å¸¸ç”¨ä¹ æƒ¯ç”¨æ³•å¦‚ä¸‹ï¼š

```perl
open my $fh, "<", "file" or die "$!";
my @lines = <$fh>;                # lines are NOT chomped 
close $fh;
```

åœ¨ Perl 6 ä¸­ï¼Œè¿™å·²ç»ç®€åŒ–ä¸º

```perl6
my @lines = "file".IO.lines;  # auto-chomped 
```

ä¸è¦è¯•å›¾å°è¯•åœ¨æ–‡ä»¶ä¸­è¿›è¡Œ slurping å¹¶å°†ç»“æœå­—ç¬¦ä¸²æ‹†åˆ†ä¸ºæ¢è¡Œç¬¦ï¼Œå› ä¸ºè¿™ä¼šç»™å‡ºä¸€ä¸ªå¸¦æœ‰å°¾éšç©ºå…ƒç´ çš„æ•°ç»„ï¼Œè¿™æ¯”ä½ é¢„æœŸçš„è¦å¤šä¸€äº›ï¼ˆå®ƒä¹Ÿæ›´å¤æ‚ï¼‰ï¼Œä¾‹å¦‚ï¼š

```perl6
# initialize the file to read 
spurt "test-file", q:to/END/; 
first line
second line
third line
END
# read the file 
my @lines = "test-file".IO.slurp.split(/\n/);
say @lines.elems;    #-> 4 
```

å¦‚æœç”±äºæŸç§åŸå› ä½ æƒ³è¦é¦–å…ˆ slurp æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å¯ä»¥åœ¨ `slurp` çš„ç»“æœä¸Šè°ƒç”¨ `lines` æ–¹æ³•ï¼š

```perl6
my @lines = "test-file".IO.slurp.lines;  # also auto-chomps 
```

å¦å¤–ï¼Œè¯·æ³¨æ„ `$!` ä¸ Perl 6 ä¸­çš„æ–‡ä»¶æ“ä½œå¤±è´¥æ— å…³ã€‚ä¸€ä¸ª IO æ“ä½œæ— æ³•è¿”å›å¤±è´¥è€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸ã€‚ å¦‚æœè¦è¿”å›å¤±è´¥æ¶ˆæ¯ï¼Œåˆ™å®ƒæœ¬èº«å°±æ˜¯å¤±è´¥ï¼Œè€Œä¸æ˜¯ `$!`. è¦åšåŒæ ·çš„äº‹æƒ…ï¼Œæˆ‘éœ€è¦æ£€æŸ¥å¹¶æŠ¥å‘Š Perl 5ï¼š

```perl
my $fh = open('./bad/path/to/file', :w) or die $fh;
```

æ³¨æ„ï¼š`$fh` è€Œä¸æ˜¯ `$!`. ç°åœ¨ï¼Œæ‚¨å¯ä»¥å°† `$_` è®¾ç½®ä¸ºå¤±è´¥å¹¶ä½¿ç”¨ `$_` æ¥æ¶ˆäº¡ï¼š

```perl6
my $fh = open('./bad/path/to/file', :w) orelse .die;
```

å°è¯•ä½¿ç”¨å¤±è´¥çš„ä»»ä½•æ“ä½œéƒ½å°†å¯¼è‡´ç¨‹åºå‡ºé”™å¹¶ç»ˆæ­¢ã€‚å³ä½¿åªæ˜¯è°ƒç”¨ `.self` æ–¹æ³•ä¹Ÿè¶³å¤Ÿäº†ã€‚

```perl6
my $fh = open('./bad/path/to/file', :w).self;
```

==== æ•è·å¯æ‰§è¡Œæ–‡ä»¶çš„æ ‡å‡†è¾“å‡ºã€‚

è€Œåœ¨ Perl 5 ä¸­ï¼Œä½ ä¼šè¿™æ ·åš

```perl
my $arg = 'Hello';
my $captured = `echo \Q$arg\E`;
my $captured = qx(echo \Q$arg\E);
```

æˆ–è€…ä½¿ç”¨ `String::ShellQuote`ï¼ˆå› ä¸º `\Q...\E` ä¸å®Œå…¨æ­£ç¡®ï¼‰ï¼š

```perl
my $arg = shell_quote 'Hello';
my $captured = `echo $arg`;
my $captured = qx(echo $arg);
```

åœ¨ Perl 6 ä¸­ï¼Œæ‚¨å¯èƒ½å¸Œæœ›åœ¨ä¸ä½¿ç”¨ shell çš„æƒ…å†µä¸‹è¿è¡Œå‘½ä»¤ï¼š

```perl6
my $arg = 'Hello';
my $captured = run('echo', $arg, :out).out.slurp;
my $captured = run(Â«echo "$arg"Â», :out).out.slurp;
```

å¦‚æœä½ çœŸçš„æƒ³è¦ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ shellï¼š

```perl6
my $arg = 'Hello';
my $captured = shell("echo $arg", :out).out.slurp;
my $captured = qqx{echo $arg};
```

ä½†è¯·æ³¨æ„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ ¹æœ¬æ²¡æœ‰ä¿æŠ¤ï¼ `run` ä¸ä½¿ç”¨ shellï¼Œå› æ­¤ä¸éœ€è¦è½¬ä¹‰å‚æ•°ï¼ˆå‚æ•°ç›´æ¥ä¼ é€’ï¼‰ã€‚å¦‚æœä½ ä½¿ç”¨ shell æˆ– `qqx`ï¼Œé‚£ä¹ˆä¸€åˆ‡éƒ½ä¼šå˜æˆä¸€ä¸ªé•¿å­—ç¬¦ä¸²ï¼Œç„¶åä¼ é€’ç»™ shellã€‚é™¤éæ‚¨éå¸¸ä»”ç»†åœ°éªŒè¯æ‚¨çš„å‚æ•°ï¼Œå¦åˆ™å¾ˆæœ‰å¯èƒ½ä½¿ç”¨æ­¤ç±»ä»£ç å¼•å…¥ shell æ³¨å…¥æ¼æ´ã€‚

=== ç¯å¢ƒå˜é‡

==== Perl æ¨¡å—åº“è·¯å¾„

åœ¨ Perl 5 ä¸­ï¼Œä¸º Perl æ¨¡å—æŒ‡å®šé¢å¤–æœç´¢è·¯å¾„çš„ç¯å¢ƒå˜é‡ä¹‹ä¸€æ˜¯ `PERL5LIB`ã€‚

```shell
$ PERL5LIB="/some/module/lib" perl program.pl
```

åœ¨ Perl 6 ä¸­ï¼Œè¿™æ˜¯ç±»ä¼¼çš„ï¼Œåªéœ€è¦æ”¹å˜ä¸€ä¸ªæ•°å­—ï¼æ‚¨å¯èƒ½å·²ç»çŒœåˆ°äº†ï¼Œæ‚¨åªéœ€è¦ä½¿ç”¨ `PERL6LIB`ï¼š

```shell
$ PERL6LIB="/some/module/lib" perl6 program.p6
```

åœ¨ Perl 5 ä¸­ï¼Œä½¿ç”¨ ':'ï¼ˆå†’å·ï¼‰ä½œä¸º `PERL5LIB` çš„ç›®å½•åˆ†éš”ç¬¦ï¼Œä½†åœ¨ Perl 6 ä¸­ä½¿ç”¨ ','ï¼ˆé€—å·ï¼‰ã€‚ä¾‹å¦‚ï¼š

```shell
$ export PERL5LIB=/module/dir1:/module/dir2;
```

ä½†æ˜¯

```perl6
$ export PERL6LIB=/module/dir1,/module/dir2;
```

ï¼ˆPerl 6 æ— æ³•è¯†åˆ« `PERL5LIB` æˆ–æ—§çš„ Perl ç¯å¢ƒå˜é‡ `PERLLIB`ã€‚ï¼‰

ä¸ Perl 5 ä¸€æ ·ï¼Œå¦‚æœæœªæŒ‡å®š `PERL6LIB`ï¼Œåˆ™éœ€è¦é€šè¿‡ `use lib` pragma æŒ‡å®šç¨‹åºä¸­çš„åº“è·¯å¾„ï¼š

```perl6
use lib '/some/module/lib'
```

è¯·æ³¨æ„ï¼Œ`PERL6LIB` åœ¨ Perl 6 ä¸­æ›´å…·å¼€å‘äººå‘˜ä¾¿åˆ©æ€§ï¼ˆä¸ Perl5 ä¸­ `PERL5LIB` çš„ç­‰æ•ˆç”¨æ³•ç›¸åï¼‰ï¼Œæ¨¡å—æ¶ˆè´¹è€…ä¸åº”ä½¿ç”¨å®ƒï¼Œå› ä¸ºå°†æ¥å¯èƒ½ä¼šå°†å…¶åˆ é™¤ã€‚è¿™æ˜¯å› ä¸º Perl 6 çš„æ¨¡å—åŠ è½½ä¸æ“ä½œç³»ç»Ÿè·¯å¾„ä¸ç›´æ¥å…¼å®¹ã€‚

=== Misc

==== '0' ä¸ºçœŸ

ä¸ Perl 5 ä¸åŒï¼ŒåªåŒ…å«é›¶ï¼ˆ'0'ï¼‰çš„å­—ç¬¦ä¸²ä¸º `True`ã€‚ç”±äº Perl 6 å…·æœ‰æ ¸å¿ƒç±»å‹ï¼Œå› æ­¤æ›´æœ‰æ„ä¹‰ã€‚è¿™ä¹Ÿæ„å‘³ç€å¸¸è§çš„æ¨¡å¼ï¼š

```perl
... if defined $x and length $x; # or just length() in modern perls 
```

åœ¨ Perl 6 ä¸­å˜çš„ç®€å•

```perl
... if $x;
```

==== dump


ä¸è§äº†ã€‚

Perl 6 è®¾è®¡å…è®¸è‡ªåŠ¨é€æ˜åœ°ä¿å­˜å’ŒåŠ è½½ç¼–è¯‘çš„å­—èŠ‚ç ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒRakudo ä»…æ”¯æŒæ¨¡å—ã€‚

=== AUTOLOAD

link:https://docs.perl6.org/language/typesystem#index-entry-FALLBACK_%28method%29[FALLBACK] æ–¹æ³•æä¾›ç±»ä¼¼çš„åŠŸèƒ½ã€‚

==== ä»æ¨¡å—å¯¼å…¥ç‰¹å®šå‡½æ•°

åœ¨ Perl 5 ä¸­ï¼Œå¯ä»¥é€‰æ‹©æ€§åœ°ä»ç»™å®šæ¨¡å—å¯¼å…¥å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```perl
use ModuleName qw{foo bar baz};
```

åœ¨ Perl 6 ä¸­ï¼Œé€šè¿‡ä½¿ç”¨ç›¸å…³å­èŠ‚ç‚¹ä¸Šçš„ `is export` è§’è‰²æ¥æŒ‡å®šè¦å¯¼å‡ºçš„å‡½æ•°;ç„¶åå¯¼å‡ºå…·æœ‰æ­¤è§’è‰²çš„æ‰€æœ‰ *subs*ã€‚å› æ­¤ï¼Œä»¥ä¸‹æ¨¡å— `Bar` å¯¼å‡º subs `foo` å’Œ `bar` ä½†ä¸å¯¼å‡º `baz`ï¼š

```perl6
unit module Bar;
 
sub foo($a) is export { say "foo $a" }
sub bar($b) is export { say "bar $b" }
sub baz($z) { say "baz $z" }
```

è¦ä½¿ç”¨æ­¤æ¨¡å—ï¼Œåªéœ€ `use Bar`ï¼Œå³å¯ä½¿ç”¨ `foo` å’Œ `bar` å‡½æ•°

```perl6
use Bar;
foo(1);    #=> "foo 1" 
bar(2);    #=> "bar 2" 
```

å¦‚æœå°è¯•ä½¿ç”¨ `baz`ï¼Œåˆ™ä¼šåœ¨ç¼–è¯‘æ—¶å¼•å‘â€œæœªå£°æ˜çš„ä¾‹ç¨‹â€é”™è¯¯ã€‚

é‚£ä¹ˆï¼Œå¦‚ä½•é‡æ–°åˆ›å»ºèƒ½å¤Ÿæœ‰é€‰æ‹©åœ°å¯¼å…¥å‡½æ•°çš„ Perl 5 è¡Œä¸ºå‘¢ï¼Ÿé€šè¿‡åœ¨æ¨¡å—å†…å®šä¹‰ä¸€ä¸ª `EXPORT` subï¼Œå®ƒæŒ‡å®šè¦å¯¼å‡ºçš„å‡½æ•°å¹¶åˆ é™¤ `module Bar` è¯­å¥ã€‚

ä»¥å‰çš„æ¨¡å— `Bar` ç°åœ¨åªæ˜¯ä¸€ä¸ªåä¸º `Bar.pm6` çš„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š


```perl6
sub EXPORT(*@import-list) {
    my %exportable-subs =
        '&foo' => &foo,
        '&bar' => &bar,
        ;
    my %subs-to-export;
    for @import-list -> $import {
        if grep $sub-name, %exportable-subs.keys {
            %subs-to-export{$sub-name} = %exportable-subs{$sub-name};
        }
    }
    return %subs-to-export;
}
 
sub foo($a, $b, $c) { say "foo, $a, $b, $c" }
sub bar($a) { say "bar, $a" }
sub baz($z) { say "baz, $z" }
```

æ³¨æ„ï¼Œä¸å†é€šè¿‡ `is export` è§’è‰²æ˜¾å¼åœ°å¯¼å‡º subsï¼Œè€Œæ˜¯é€šè¿‡ `EXPORT` sub æŒ‡å®šæˆ‘ä»¬æƒ³è¦å¯¼å‡ºçš„æ¨¡å—ä¸­çš„ subsï¼Œç„¶åæˆ‘ä»¬å¡«å……ä¸€ä¸ªåŒ…å«å®é™…å°†è¢«å¯¼å‡ºçš„ subs çš„å“ˆå¸Œã€‚ `@import-list` ç”±è°ƒç”¨ä»£ç ä¸­çš„ `use` è¯­å¥è®¾ç½®ï¼Œå› æ­¤å…è®¸æˆ‘ä»¬æœ‰é€‰æ‹©åœ°å¯¼å…¥æ¨¡å—å¯ç”¨çš„ subsã€‚

å› æ­¤ï¼Œè¦ä»…å¯¼å…¥ `foo` ä¾‹ç¨‹ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨ä»£ç ä¸­æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

```perl6
use Bar <foo>;
foo(1);       #=> "foo 1" 
```

åœ¨è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°å³ä½¿ `bar` æ˜¯å¯å¯¼å‡ºçš„ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰æ˜ç¡®åœ°å¯¼å…¥å®ƒï¼Œå®ƒä¹Ÿæ— æ³•ä½¿ç”¨ã€‚å› æ­¤ï¼Œè¿™ä¼šåœ¨ç¼–è¯‘æ—¶å¯¼è‡´â€œæœªå£°æ˜çš„ä¾‹ç¨‹â€é”™è¯¯ï¼š

```perl6
use Bar <foo>;
foo(1);
bar(5);       #!> "Undeclared routine: bar used at line 3" 
```

ä½†æ˜¯ï¼Œè¿™å°†æœ‰æ•ˆ

```perl6
use Bar <foo bar>;
foo(1);       #=> "foo 1" 
bar(5);       #=> "bar 5" 
```

å¦è¯·æ³¨æ„ï¼Œå³ä½¿åœ¨ `use` è¯­å¥ä¸­æŒ‡å®šï¼Œ`baz` ä»ç„¶ä¸å¯å¯¼è‡´ï¼š

```perl6
use Bar <foo bar baz>;
baz(3);       #!> "Undeclared routine: baz used at line 2" 
```

ä¸ºäº†ä½¿è¿™ä¸ªå·¥ä½œï¼Œæ˜¾ç„¶å¿…é¡»è·³è¿‡è®¸å¤šç®ã€‚åœ¨æ ‡å‡†ç”¨ä¾‹ä¸­ï¼Œé€šè¿‡ `is export` è§’è‰²æŒ‡å®šè¦å¯¼å‡ºçš„å‡½æ•°ï¼ŒPerl 6 ä¼šä»¥æ­£ç¡®çš„æ–¹å¼ä¸ºæ‚¨è‡ªåŠ¨åˆ›å»º `EXPORT` subï¼Œå› æ­¤åº”è¯¥éå¸¸ä»”ç»†åœ°è€ƒè™‘æ˜¯å¦å€¼å¾—ç¼–å†™è‡ªå·±çš„ `EXPORT` ä¾‹ç¨‹ã€‚

==== ä»æ¨¡å—å¯¼å…¥ç‰¹å®šå‡½æ•°ç»„

å¦‚æœè¦ä»æ¨¡å—ä¸­å¯¼å‡ºå‡½æ•°ç»„ï¼Œåªéœ€è¦ä¸ºç»„åˆ†é…åç§°ï¼Œå…¶ä½™çš„å°†è‡ªåŠ¨è¿è¡Œã€‚å¦‚æœåœ¨ sub å£°æ˜ä¸­æŒ‡å®š `is  export`ï¼Œåˆ™å®é™…ä¸Šæ˜¯å°†æ­¤å­ä¾‹ç¨‹æ·»åŠ åˆ° `:DEFAULT` å¯¼å‡ºç»„ã€‚ä½†æ˜¯æ‚¨å¯ä»¥å°†å­ä¾‹ç¨‹æ·»åŠ åˆ°å¦ä¸€ä¸ªç»„æˆ–å¤šä¸ªç»„ï¼š

```perl6
unit module Bar;
sub foo() is export { }                   # added by default to :DEFAULT 
sub bar() is export(:FNORBL) { }          # added to the FNORBL export group 
sub baz() is export(:DEFAULT:FNORBL) { }  # added to both 
```

æ‰€ä»¥ç°åœ¨ä½ å¯ä»¥åƒè¿™æ ·ä½¿ç”¨ `Bar` æ¨¡å—ï¼š

```perl6
use Bar;                     # imports foo / baz 
use Bar :FNORBL;             # imports bar / baz 
use Bar :ALL;                # imports foo / bar / baz 
```

è¯·æ³¨æ„ `:ALL` æ˜¯ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆçš„ç»„ï¼Œå®ƒåŒ…å«å…·æœ‰ `is export` trait çš„æ‰€æœ‰å­ä¾‹ç¨‹ã€‚


=== æ ¸å¿ƒæ¨¡å—

==== Data::Dumper

åœ¨ Perl 5 ä¸­ï¼Œlink:https://metacpan.org/pod/Data::Dumper[Data::Dumper] æ¨¡å—ç”¨äºåºåˆ—åŒ–ï¼Œä»¥åŠç¨‹åºå‘˜è°ƒè¯•ç¨‹åºæ•°æ®ç»“æ„çš„è§†å›¾ã€‚

åœ¨ Perl 6 ä¸­ï¼Œè¿™äº›ä»»åŠ¡æ˜¯ä½¿ç”¨ `.perl` æ–¹æ³•å®Œæˆçš„ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ `.perl` æ–¹æ³•ã€‚

```perl
# Given: 
    my @array_of_hashes = (
        { NAME => 'apple',   type => 'fruit' },
        { NAME => 'cabbage', type => 'no, please no' },
    );
# Perl 5 
    use Data::Dumper;
    $Data::Dumper::Useqq = 1;
    print Dumper \@array_of_hashes; # Note the backslash. 

```

```perl6
# Perl 6 
say @array_of_hashes.perl; # .perl on the array, not on its reference. 
```

åœ¨ Perl 5 ä¸­ï¼ŒData::Dumper å…·æœ‰æ›´å¤æ‚çš„å¯é€‰è°ƒç”¨çº¦å®šï¼Œå…è®¸å‘½å VARã€‚

åœ¨ Perl 6 ä¸­ï¼Œåœ¨å˜é‡çš„ sigil å‰é¢æ”¾ç½®ä¸€ä¸ªå†’å·ï¼Œå°†å…¶è½¬æ¢ä¸ºä¸€ä¸ª Pairï¼Œå…¶ä¸­åŒ…å« var åç§°çš„é”®å’Œ var å€¼çš„å€¼ã€‚

```perl6
# Given: 
    my ( $foo, $bar ) = ( 42, 44 );
    my @baz = ( 16, 32, 64, 'Hike!' );
# Perl 5 
    use Data::Dumper;
    print Data::Dumper->Dump(
        [     $foo, $bar, \@baz   ],
        [ qw(  foo   bar   *baz ) ],
    );
# Output 
#    $foo = 42; 
#    $bar = 44; 
#    @baz = ( 
#             16, 
#             32, 
#             64, 
#             'Hike!' 
#           ); 
```

```perl6
# Perl 6 
say [ :$foo, :$bar, :@baz ].perl;
# OUTPUT: Â«["foo" => 42, "bar" => 44, "baz" => [16, 32, 64, "Hike!"]]Â» 
```

å¯¹äºå¼€å‘äººå‘˜æ¥è¯´ï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹å®šäº Rakudo çš„è°ƒè¯•è¾…åŠ©å·¥å…·ï¼Œç§°ä¸º `dd`ï¼ˆTiny Data Dumperï¼Œå®ƒå¾ˆå°ï¼Œå®ƒå¤±å»äº†â€œtâ€ï¼‰ã€‚è¿™å°†æ‰“å° STDERR ä¸Šç»™å®šå˜é‡çš„ `.perl` è¡¨ç¤ºå’Œä¸€äº›å¯ä»¥åçœçš„é¢å¤–ä¿¡æ¯ï¼š

```perl6
# Perl 6 
dd $foo, $bar, @baz;
# OUTPUT: Â«Int $foo = 42
# Int $bar = 44
# Array @baz = [16, 32, 64, "Hike!"]
# Â» 
```

==== Getopt::Long

åˆ‡æ¢è§£æç°åœ¨ç”± `MAIN` å­ä¾‹ç¨‹çš„å‚æ•°åˆ—è¡¨å®Œæˆã€‚

```perl
# Perl 5 
    use 5.010;
    use Getopt::Long;
    GetOptions(
        'length=i' => \( my $length = 24       ), # numeric 
        'file=s'   => \( my $data = 'file.dat' ), # string 
        'verbose'  => \( my $verbose           ), # flag 
    ) or die;
    say $length;
    say $data;
    say 'Verbosity ', ($verbose ? 'on' : 'off') if defined $verbose;
perl example.pl
    24
    file.dat
perl example.pl --file=foo --length=42 --verbose
    42
    foo
    Verbosity on
 
perl example.pl --length=abc
    Value "abc" invalid for option length (number expected)
    Died at c.pl line 3.
```

```perl6
# Perl 6 
    sub MAIN( Int :$length = 24, :file($data) = 'file.dat', Bool :$verbose ) {
        say $length if $length.defined;
        say $data   if $data.defined;
        say 'Verbosity ', ($verbose ?? 'on' !! 'off');
    }

```

```shell
perl6 example.p6
    24
    file.dat
    Verbosity off
perl6 example.p6 --file=foo --length=42 --verbose
    42
    foo
    Verbosity on
perl6 example.p6 --length=abc
    Usage:
      c.p6 [--length=<Int>] [--file=<Any>] [--verbose]
```

è¯·æ³¨æ„ï¼ŒPerl 6 ä¼šåœ¨å‘½ä»¤è¡Œè§£ææ—¶è‡ªåŠ¨ç”Ÿæˆé”™è¯¯çš„å®Œæ•´ç”¨æ³•æ¶ˆæ¯ã€‚

=== è‡ªåŠ¨ç¿»è¯‘

æŸ¥æ‰¾ Perl 6 ç‰ˆæœ¬çš„ Perl 5 æ„é€ çš„å¿«é€Ÿæ–¹æ³•æ˜¯é€šè¿‡è‡ªåŠ¨ç¿»è¯‘å™¨è¿è¡Œå®ƒã€‚

æ³¨æ„ï¼šè¿™äº›ç¿»è¯‘äººå‘˜å°šæœªå®Œæˆã€‚

==== è“è™

è¯¥é¡¹ç›®è‡´åŠ›äº Perl ä»£ç çš„è‡ªåŠ¨åŒ–ç°ä»£åŒ–ã€‚å®ƒï¼ˆè¿˜ï¼‰æ²¡æœ‰ Web å‰ç«¯ï¼Œå› æ­¤å¿…é¡»åœ¨æœ¬åœ°å®‰è£…æ‰æœ‰ç”¨ã€‚å®ƒè¿˜åŒ…å«ä¸€ä¸ªå•ç‹¬çš„ç¨‹åºï¼Œç”¨äºå°† Perl 5 æ­£åˆ™è¡¨è¾¾å¼è½¬æ¢ä¸º Perl 6ã€‚

link:https://github.com/Util/Blue_Tiger/[https://github.com/Util/Blue_Tiger/]

==== Perlito

åœ¨çº¿ç¿»è¯‘ï¼

è¯¥é¡¹ç›®æ˜¯ä¸€å¥— Perl äº¤å‰ç¼–è¯‘å™¨ï¼ŒåŒ…æ‹¬ Perl 5 åˆ° 6 çš„è½¬æ¢ã€‚å®ƒæœ‰ä¸€ä¸ª Web å‰ç«¯ï¼Œå› æ­¤æ— éœ€å®‰è£…å³å¯ä½¿ç”¨ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå®ƒä»…æ”¯æŒ Perl 5 è¯­æ³•çš„å­é›†ã€‚

link:https://fglock.github.io/Perlito/perlito/perlito5.html[https://fglock.github.io/Perlito/perlito/perlito5.html]

==== Perl-ToPerl6

Jeff Goff ä¸º Perl 5 è®¾è®¡çš„ link:https://metacpan.org/release/JGOFF/Perl-ToPerl6-0.03[Perl::ToPerl6] æ¨¡å—æ˜¯å›´ç»• Perl::Critic çš„æ¡†æ¶è®¾è®¡çš„ã€‚å®ƒæ—¨åœ¨å°† Perl5 è½¬æ¢ä¸ºå¯ç¼–è¯‘ï¼ˆå¦‚æœä¸ä¸€å®šè¿è¡Œï¼‰çš„ Perl 6 ä»£ç ï¼Œåªéœ€è¿›è¡Œæœ€å°‘çš„æ›´æ”¹ã€‚ä»£ç è½¬æ¢å™¨æ˜¯å¯é…ç½®å’Œå¯æ’æ‹”çš„ï¼Œå› æ­¤æ‚¨å¯ä»¥åˆ›å»ºå’Œè´¡çŒ®è‡ªå·±çš„è½¬æ¢ï¼Œå¹¶æ ¹æ®è‡ªå·±çš„éœ€è¦å®šåˆ¶ç°æœ‰çš„è½¬æ¢ã€‚æ‚¨å¯ä»¥ä» CPAN å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥åœ¨ GitHub ä¸Šå®æ—¶å…³æ³¨é¡¹ç›®ã€‚åœ¨çº¿è½¬æ¢å™¨å¯èƒ½åœ¨æŸäº›æ—¶å€™å¯ç”¨ã€‚

==== å…¶ä»–ç¿»è¯‘çŸ¥è¯†æ¥æº

- link:https://perlgeek.de/en/article/5-to-6[https://perlgeek.de/en/article/5-to-6]
- link:https://github.com/Util/Blue_Tiger/[https://github.com/Util/Blue_Tiger/]
- link:https://perl6advent.wordpress.com/2011/12/23/day-23-idiomatic-perl-6/[https://perl6advent.wordpress.com/2011/12/23/day-23-idiomatic-perl-6/]
- link:https://docs.perl6.org/language/5to6-overview[https://docs.perl6.org/language/5to6-overview]

